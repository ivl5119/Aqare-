<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>النخبة العقارية - الموقع الأفضل للعقارات</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --color-primary: #2C3E50;
            --color-secondary: #3498DB;
            --color-accent: #E74C3C;
            --color-success: #28A745;
            --color-warning: #FFC107;
            --border-radius: 0.5rem;
        }
        
        .bg-primary-custom { background-color: var(--color-primary); }
        .bg-secondary-custom { background-color: var(--color-secondary); }
        .bg-accent-custom { background-color: var(--color-accent); }
        .bg-success-custom { background-color: var(--color-success); }
        .bg-warning-custom { background-color: var(--color-warning); }
        
        .text-primary-custom { color: var(--color-primary); }
        .text-secondary-custom { color: var(--color-secondary); }
        .text-accent-custom { color: var(--color-accent); }
        .text-success-custom { color: var(--color-success); }
        .text-warning-custom { color: var(--color-warning); }
        
        .border-primary-custom { border-color: var(--color-primary); }
        .border-secondary-custom { border-color: var(--color-secondary); }
        .border-accent-custom { border-color: var(--color-accent); }
        .border-success-custom { border-color: var(--color-success); }
        .border-warning-custom { border-color: var(--color-warning); }
        
        .btn-primary-custom {
            background-color: var(--color-primary);
            color: white;
            border-radius: var(--border-radius);
        }
        
        .btn-secondary-custom {
            background-color: var(--color-secondary);
            color: white;
            border-radius: var(--border-radius);
        }
        
        .btn-accent-custom {
            background-color: var(--color-accent);
            color: white;
            border-radius: var(--border-radius);
        }
        
        .btn-success-custom {
            background-color: var(--color-success);
            color: white;
            border-radius: var(--border-radius);
        }
        
        .btn-warning-custom {
            background-color: var(--color-warning);
            color: #333;
            border-radius: var(--border-radius);
        }
        
        .rounded-custom {
            border-radius: var(--border-radius);
        }
        
        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.3s ease-out forwards;
        }
    </style>
    <script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    primary: '#2C3E50',
                    secondary: '#3498DB',
                    accent: '#E74C3C',
                    success: '#28A745',
                    warning: '#FFC107',
                    light: '#F8F9FA',
                    dark: '#343A40'
                },
                fontFamily: {
                    'cairo': ['Cairo', 'sans-serif']
                }
            }
        }
    };
    </script>
    
    <script src="admin-dashboard.js"></script>
    <script src="broker-registration.js"></script>
    <script src="property-management.js"></script>
    
    <script>
            }
        }
    };
    </script>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            overflow-x: hidden;
        }
        /* Custom Carousel Styles */
        .carousel {
            position: relative;
            overflow: hidden;
        }
        .carousel-inner {
            display: flex;
            transition: transform 0.5s ease;
        }
        .carousel-item {
            flex: 0 0 100%;
        }
        /* Custom Form Styles */
        .form-control:focus {
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        /* Modern UI Improvements */
        .card-hover {
            transition: all 0.3s;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            border: none;
            color: white;
            transition: all 0.3s;
        }
        
        .btn-gradient:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .custom-shadow {
            box-shadow: 0 5px 30px rgba(0,0,0,0.08);
        }
        
        .glassmorphism {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        
        /* Colors with CSS variables for theme customization */
        :root {
            --color-primary: #2C3E50;
            --color-secondary: #3498DB;
            --color-accent: #E74C3C;
            --color-success: #28A745;
            --color-warning: #FFC107;
            --color-light: #F8F9FA;
            --color-dark: #343A40;
            --font-base: 'Cairo', sans-serif;
            --border-radius: 0.5rem;
        }
        
        /* Theme application */
        .bg-primary {
            background-color: var(--color-primary) !important;
        }
        .bg-secondary {
            background-color: var(--color-secondary) !important;
        }
        .bg-accent {
            background-color: var(--color-accent) !important;
        }
        .bg-success {
            background-color: var(--color-success) !important;
        }
        .text-primary {
            color: var(--color-primary) !important;
        }
        .text-secondary {
            color: var(--color-secondary) !important;
        }
        .text-accent {
            color: var(--color-accent) !important;
        }
        .border-primary {
            border-color: var(--color-primary) !important;
        }
        .border-secondary {
            border-color: var(--color-secondary) !important;
        }
        
        /* Color Picker Styles */
        .color-picker {
            width: 100%;
            height: 40px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            background: none;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-secondary);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-primary);
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Theme Settings Modal -->
    <div id="themeSettingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-4xl max-h-screen overflow-y-auto" dir="rtl">
            <div class="border-b px-6 py-4 flex items-center justify-between bg-primary text-white">
                <h3 class="text-xl font-bold">نظام تخصيص التصميم</h3>
                <button id="closeThemeSettings" class="text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Tabs -->
            <div class="border-b">
                <div class="flex">
                    <button id="tabBasicSettings" class="px-6 py-3 font-medium text-primary border-b-2 border-primary">التخصيص الأساسي</button>
                    <button id="tabTemplates" class="px-6 py-3 font-medium text-gray-500 hover:text-primary">قوالب جاهزة</button>
                    <button id="tabAdvanced" class="px-6 py-3 font-medium text-gray-500 hover:text-primary">خيارات متقدمة</button>
                    <button id="tabFonts" class="px-6 py-3 font-medium text-gray-500 hover:text-primary">الخطوط</button>
                </div>
            </div>
            
            <div class="p-6">
                <!-- Tab content: Basic Settings -->
                <div id="tabContentBasic" class="block">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-lg font-bold mb-4">الألوان الرئيسية</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">اللون الرئيسي</label>
                                    <input type="color" id="primaryColor" class="color-picker" value="#2C3E50">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">اللون الثانوي</label>
                                    <input type="color" id="secondaryColor" class="color-picker" value="#3498DB">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">لون التأكيد</label>
                                    <input type="color" id="accentColor" class="color-picker" value="#E74C3C">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">لون النجاح</label>
                                    <input type="color" id="successColor" class="color-picker" value="#28A745">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">لون التحذير</label>
                                    <input type="color" id="warningColor" class="color-picker" value="#FFC107">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">لون النص</label>
                                    <input type="color" id="textColor" class="color-picker" value="#333333">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">لون الخلفية</label>
                                    <input type="color" id="backgroundColor" class="color-picker" value="#F8F9FA">
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-bold mb-4">الشعار والعناصر المرئية</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">شعار الموقع</label>
                                    <div class="flex items-center">
                                        <div id="logoPreview" class="w-20 h-20 bg-gray-200 rounded-lg flex items-center justify-center overflow-hidden mr-4">
                                            <i class="fas fa-building text-4xl text-gray-400"></i>
                                        </div>
                                        <div>
                                            <input type="file" id="logoUpload" class="hidden" accept="image/*">
                                            <button id="logoUploadBtn" class="bg-secondary text-white px-3 py-2 rounded-lg text-sm hover:bg-opacity-80 transition duration-300">
                                                اختيار شعار
                                            </button>
                                            <p class="text-xs text-gray-500 mt-1">الحجم المناسب: 200×200 بكسل</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">شعار المصغر (Favicon)</label>
                                    <div class="flex items-center">
                                        <div id="faviconPreview" class="w-8 h-8 bg-gray-200 rounded-lg flex items-center justify-center overflow-hidden mr-4">
                                            <i class="fas fa-home text-xs text-gray-400"></i>
                                        </div>
                                        <div>
                                            <input type="file" id="faviconUpload" class="hidden" accept="image/*">
                                            <button id="faviconUploadBtn" class="bg-secondary text-white px-3 py-2 rounded-lg text-sm hover:bg-opacity-80 transition duration-300">
                                                اختيار شعار
                                            </button>
                                            <p class="text-xs text-gray-500 mt-1">الحجم المناسب: 64×64 بكسل</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">اسم المنصة</label>
                                    <input type="text" id="siteName" class="w-full p-2 border border-gray-300 rounded-lg" value="النخبة العقارية">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">نمط العناصر</label>
                                    <div class="grid grid-cols-3 gap-2">
                                        <button class="border p-2 rounded-lg text-center text-sm radius-option active bg-secondary text-white" data-radius="0.5">
                                            دائري خفيف
                                        </button>
                                        <button class="border p-2 rounded-none text-center text-sm radius-option" data-radius="0">
                                            مربع
                                        </button>
                                        <button class="border p-2 rounded-full text-center text-sm radius-option" data-radius="2">
                                            دائري كامل
                                        </button>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">نمط القائمة الرئيسية</label>
                                    <select id="menuStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="standard">قائمة قياسية</option>
                                        <option value="centered">قائمة وسطية</option>
                                        <option value="hamburger">قائمة جانبية</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">نمط التذييل (Footer)</label>
                                    <select id="footerStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="standard">تذييل قياسي</option>
                                        <option value="compact">تذييل مختصر</option>
                                        <option value="expanded">تذييل موسع</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="my-6">
                    
                    <div>
                        <h4 class="text-lg font-bold mb-4">معاينة التصميم</h4>
                        <div class="border rounded-lg p-4 bg-gray-100">
                            <div class="flex space-x-4 space-x-reverse mb-4">
                                <div id="previewPrimary" class="w-12 h-12 rounded-lg bg-primary"></div>
                                <div id="previewSecondary" class="w-12 h-12 rounded-lg bg-secondary"></div>
                                <div id="previewAccent" class="w-12 h-12 rounded-lg bg-accent"></div>
                                <div id="previewSuccess" class="w-12 h-12 rounded-lg bg-success"></div>
                                <div id="previewWarning" class="w-12 h-12 rounded-lg bg-warning"></div>
                            </div>
                            
                            <div class="flex flex-wrap gap-2 mb-4">
                                <button id="previewBtn1" class="bg-primary text-white px-4 py-2 rounded-lg">زر رئيسي</button>
                                <button id="previewBtn2" class="bg-secondary text-white px-4 py-2 rounded-lg">زر ثانوي</button>
                                <button id="previewBtn3" class="bg-accent text-white px-4 py-2 rounded-lg">زر تأكيد</button>
                                <button id="previewBtn4" class="btn-gradient text-white px-4 py-2 rounded-lg">زر متدرج</button>
                            </div>
                            
                            <div class="bg-white p-4 rounded-lg shadow-md">
                                <h5 id="previewTitle" class="text-lg font-bold text-primary mb-2">عنوان تجريبي</h5>
                                <p class="text-gray-600">هذا نص تجريبي لمعاينة التصميم الجديد للموقع.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab content: Templates -->
                <div id="tabContentTemplates" class="hidden">
                    <h4 class="text-lg font-bold mb-4">اختر قالب جاهز</h4>
                    <p class="text-gray-600 mb-4">يمكنك اختيار أحد القوالب الجاهزة ثم تخصيصه حسب احتياجاتك.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Template 1: Modern Real Estate -->
                        <div class="border rounded-lg overflow-hidden cursor-pointer transition-all hover:shadow-lg template-card" data-template="modern">
                            <div class="h-40 bg-gradient-to-r from-blue-600 to-blue-400 p-4 flex items-center justify-center">
                                <div class="text-center text-white">
                                    <i class="fas fa-building text-3xl mb-2"></i>
                                    <h5 class="font-bold">قالب عقارك الحديث</h5>
                                </div>
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm text-gray-600 mb-2">قالب عصري بألوان زرقاء وتصميم أنيق</p>
                                <button class="w-full bg-blue-500 text-white py-1 rounded-lg text-sm apply-template" data-template="modern">تطبيق القالب</button>
                            </div>
                        </div>
                        
                        <!-- Template 2: Luxury Real Estate -->
                        <div class="border rounded-lg overflow-hidden cursor-pointer transition-all hover:shadow-lg template-card" data-template="luxury">
                            <div class="h-40 bg-gradient-to-r from-black to-gray-800 p-4 flex items-center justify-center">
                                <div class="text-center text-white">
                                    <i class="fas fa-crown text-3xl mb-2"></i>
                                    <h5 class="font-bold">قالب العقارات الفاخرة</h5>
                                </div>
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm text-gray-600 mb-2">قالب فخم بألوان داكنة وذهبية للعقارات الراقية</p>
                                <button class="w-full bg-gray-800 text-white py-1 rounded-lg text-sm apply-template" data-template="luxury">تطبيق القالب</button>
                            </div>
                        </div>
                        
                        <!-- Template 3: Classic Real Estate -->
                        <div class="border rounded-lg overflow-hidden cursor-pointer transition-all hover:shadow-lg template-card" data-template="classic">
                            <div class="h-40 bg-gradient-to-r from-green-700 to-green-500 p-4 flex items-center justify-center">
                                <div class="text-center text-white">
                                    <i class="fas fa-home text-3xl mb-2"></i>
                                    <h5 class="font-bold">قالب العقارات الكلاسيكي</h5>
                                </div>
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm text-gray-600 mb-2">قالب تقليدي بألوان خضراء وتصميم بسيط ومريح</p>
                                <button class="w-full bg-green-600 text-white py-1 rounded-lg text-sm apply-template" data-template="classic">تطبيق القالب</button>
                            </div>
                        </div>
                        
                        <!-- Template 4: Minimalist Real Estate -->
                        <div class="border rounded-lg overflow-hidden cursor-pointer transition-all hover:shadow-lg template-card" data-template="minimalist">
                            <div class="h-40 bg-gradient-to-r from-gray-100 to-white p-4 flex items-center justify-center">
                                <div class="text-center text-gray-800">
                                    <i class="fas fa-feather text-3xl mb-2"></i>
                                    <h5 class="font-bold">قالب البساطة</h5>
                                </div>
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm text-gray-600 mb-2">قالب بسيط بألوان فاتحة وتصميم نظيف وأنيق</p>
                                <button class="w-full bg-gray-300 text-gray-800 py-1 rounded-lg text-sm apply-template" data-template="minimalist">تطبيق القالب</button>
                            </div>
                        </div>
                        
                        <!-- Template 5: Vibrant Real Estate -->
                        <div class="border rounded-lg overflow-hidden cursor-pointer transition-all hover:shadow-lg template-card" data-template="vibrant">
                            <div class="h-40 bg-gradient-to-r from-purple-600 to-pink-500 p-4 flex items-center justify-center">
                                <div class="text-center text-white">
                                    <i class="fas fa-city text-3xl mb-2"></i>
                                    <h5 class="font-bold">قالب النابض بالحياة</h5>
                                </div>
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm text-gray-600 mb-2">قالب عصري بألوان زاهية ومتنوعة وحيوية</p>
                                <button class="w-full bg-purple-500 text-white py-1 rounded-lg text-sm apply-template" data-template="vibrant">تطبيق القالب</button>
                            </div>
                        </div>
                        
                        <!-- Template 6: Warm Real Estate -->
                        <div class="border rounded-lg overflow-hidden cursor-pointer transition-all hover:shadow-lg template-card" data-template="warm">
                            <div class="h-40 bg-gradient-to-r from-orange-500 to-amber-300 p-4 flex items-center justify-center">
                                <div class="text-center text-white">
                                    <i class="fas fa-sun text-3xl mb-2"></i>
                                    <h5 class="font-bold">قالب الدفء</h5>
                                </div>
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm text-gray-600 mb-2">قالب دافئ بألوان برتقالية وصفراء وتصميم مريح</p>
                                <button class="w-full bg-orange-500 text-white py-1 rounded-lg text-sm apply-template" data-template="warm">تطبيق القالب</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab content: Advanced Settings -->
                <div id="tabContentAdvanced" class="hidden">
                    <h4 class="text-lg font-bold mb-4">إعدادات متقدمة</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">نمط بطاقات العقارات</label>
                                    <select id="cardStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="standard">بطاقات قياسية</option>
                                        <option value="compact">بطاقات مضغوطة</option>
                                        <option value="grid">شبكة بسيطة</option>
                                        <option value="modern">بطاقات عصرية</option>
                                        <option value="minimal">بطاقات مبسطة</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">تأثيرات الحركة</label>
                                    <select id="animationStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="none">بدون تأثيرات</option>
                                        <option value="fade">تلاشي</option>
                                        <option value="slide">انزلاق</option>
                                        <option value="zoom">تكبير</option>
                                        <option value="bounce">ارتداد</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ظلال العناصر</label>
                                    <select id="shadowStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="none">بدون ظلال</option>
                                        <option value="light">ظلال خفيفة</option>
                                        <option value="medium">ظلال متوسطة</option>
                                        <option value="heavy">ظلال كثيفة</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">المسافات بين العناصر</label>
                                    <select id="spacing" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="compact">متقاربة</option>
                                        <option value="normal">قياسية</option>
                                        <option value="loose">متباعدة</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">نمط صفحة التفاصيل</label>
                                    <select id="detailPageStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="standard">تخطيط قياسي</option>
                                        <option value="fullwidth">عرض كامل</option>
                                        <option value="sidebar">مع شريط جانبي</option>
                                        <option value="tabs">مع تبويبات</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">معرض الصور</label>
                                    <select id="galleryStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="slider">شريط تمرير</option>
                                        <option value="grid">شبكة</option>
                                        <option value="masonry">بناء متداخل</option>
                                        <option value="fullscreen">عرض كامل</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">تخصيص CSS</label>
                                    <textarea id="customCSS" class="w-full p-2 border border-gray-300 rounded-lg h-32 text-sm font-mono" placeholder="أضف أكواد CSS مخصصة هنا..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab content: Fonts -->
                <div id="tabContentFonts" class="hidden">
                    <h4 class="text-lg font-bold mb-4">تخصيص الخطوط</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">الخط الرئيسي</label>
                                    <select id="mainFont" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="Cairo, sans-serif">Cairo</option>
                                        <option value="Tajawal, sans-serif">Tajawal</option>
                                        <option value="Almarai, sans-serif">Almarai</option>
                                        <option value="Changa, sans-serif">Changa</option>
                                        <option value="El Messiri, sans-serif">El Messiri</option>
                                        <option value="Amiri, serif">Amiri</option>
                                        <option value="Lateef, cursive">Lateef</option>
                                        <option value="Scheherazade New, serif">Scheherazade</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">خط العناوين</label>
                                    <select id="headingFont" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="Cairo, sans-serif">Cairo</option>
                                        <option value="Tajawal, sans-serif">Tajawal</option>
                                        <option value="Almarai, sans-serif">Almarai</option>
                                        <option value="Changa, sans-serif">Changa</option>
                                        <option value="El Messiri, sans-serif">El Messiri</option>
                                        <option value="Amiri, serif">Amiri</option>
                                        <option value="Lateef, cursive">Lateef</option>
                                        <option value="Scheherazade New, serif">Scheherazade</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">حجم الخط الرئيسي</label>
                                    <select id="fontSize" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="small">صغير</option>
                                        <option value="medium" selected>متوسط</option>
                                        <option value="large">كبير</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">سماكة الخط</label>
                                    <select id="fontWeight" class="w-full p-2 border border-gray-300 rounded-lg">
                                        <option value="normal">عادي</option>
                                        <option value="medium">متوسط</option>
                                        <option value="bold">سميك</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h5 class="font-medium mb-2">معاينة الخطوط</h5>
                            <div id="fontPreview" class="border p-4 rounded-lg bg-white">
                                <h3 id="fontPreviewHeading" class="text-xl font-bold mb-2 text-primary">عنوان بالخط المختار</h3>
                                <p id="fontPreviewText" class="text-gray-700">هذا النص هو مثال لنص يمكن أن يستبدل في نفس المساحة. لقد تم توليد هذا النص من مولد النص العربى، حيث يمكنك أن تولد مثل هذا النص.</p>
                                <div class="mt-2 flex gap-2">
                                    <button class="px-3 py-1 bg-primary text-white rounded-lg text-sm">زر اختبار</button>
                                    <button class="px-3 py-1 bg-secondary text-white rounded-lg text-sm">زر آخر</button>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <h5 class="font-medium mb-2">مصادر إضافية للخطوط</h5>
                                <p class="text-sm text-gray-600 mb-2">يمكنك إضافة روابط لخطوط إضافية من Google Fonts:</p>
                                <input type="text" id="customFontURL" class="w-full p-2 border border-gray-300 rounded-lg mb-2" placeholder="مثال: https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap">
                                <button id="addCustomFont" class="w-full bg-secondary text-white px-3 py-2 rounded-lg text-sm">إضافة الخط</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-between">
                    <button id="resetTheme" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 transition duration-300">
                        استعادة الافتراضي
                    </button>
                    
                    <div>
                        <button id="exportTheme" class="border border-primary text-primary px-4 py-2 rounded-lg hover:bg-primary hover:text-white transition duration-300 ml-2">
                            <i class="fas fa-download ml-1"></i> تصدير
                        </button>
                        <button id="importTheme" class="border border-secondary text-secondary px-4 py-2 rounded-lg hover:bg-secondary hover:text-white transition duration-300 ml-2">
                            <i class="fas fa-upload ml-1"></i> استيراد
                        </button>
                        <button id="cancelThemeChanges" class="border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition duration-300 ml-2">
                            إلغاء
                        </button>
                        <button id="saveThemeChanges" class="bg-success text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                            حفظ التغييرات
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main App Container -->
    <div id="app" class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-primary text-white shadow-md">
            <div class="container mx-auto px-4 py-3">
                <div class="flex flex-wrap items-center justify-between">
                    <div class="flex items-center">
                        <h1 class="text-2xl font-bold">النخبة العقارية</h1>
                        <div class="mr-4 px-3 py-1 bg-secondary rounded-full text-sm">
                            <span id="visitorCount">1,245</span> زائر
                        </div>
                    </div>
                    <div class="flex items-center space-x-2 space-x-reverse mt-2 sm:mt-0">
                        <div class="dropdown relative mr-2 hidden" id="userMenuContainer">
                            <button id="userMenuBtn" class="flex items-center space-x-2 space-x-reverse bg-secondary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                                <span id="loggedInUsername">اسم المستخدم</span>
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <div id="userDropdown" class="dropdown-menu hidden absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg z-10">
                                <div class="py-1">
                                    <a href="#" id="adminDashboardBtn" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">لوحة تحكم المشرف</a>
                                    <a href="#" id="agentDashboardBtn" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">لوحة تحكم الوسيط</a>
                                    <a href="#" id="adminThemeBtn" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">تخصيص التصميم</a>
                                    <hr class="my-1 border-gray-200">
                                    <a href="#" id="logoutBtn" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">تسجيل الخروج</a>
                                </div>
                            </div>
                        </div>
                        
                        <button id="loginBtn" class="bg-transparent border border-white hover:bg-white hover:text-primary px-4 py-2 rounded-lg transition duration-300">تسجيل الدخول</button>
                        <button id="registerBtn" class="bg-accent hover:bg-opacity-80 px-4 py-2 rounded-lg transition duration-300">تسجيل جديد</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- قائمة أنواع العقارات الرئيسية في الأعلى -->
        <div class="bg-white shadow-md py-3 mb-1 sticky top-0 z-20">
            <div class="container mx-auto">
                <div class="flex justify-center space-x-2 space-x-reverse overflow-x-auto pb-1">
                    <a href="#" class="flex flex-col items-center min-w-[80px] px-3 py-2 rounded-lg bg-primary bg-opacity-10 hover:bg-opacity-20 transition-all">
                        <i class="fas fa-building text-primary text-xl mb-1"></i>
                        <span class="text-sm font-bold text-primary">عمائر</span>
                    </a>
                    <a href="#" class="flex flex-col items-center min-w-[80px] px-3 py-2 rounded-lg hover:bg-gray-100 transition-all">
                        <i class="fas fa-home text-primary text-xl mb-1"></i>
                        <span class="text-sm font-bold">فلل</span>
                    </a>
                    <a href="#" class="flex flex-col items-center min-w-[80px] px-3 py-2 rounded-lg hover:bg-gray-100 transition-all">
                        <i class="fas fa-city text-primary text-xl mb-1"></i>
                        <span class="text-sm font-bold">شقق</span>
                    </a>
                    <a href="#" class="flex flex-col items-center min-w-[80px] px-3 py-2 rounded-lg hover:bg-gray-100 transition-all">
                        <i class="fas fa-map text-primary text-xl mb-1"></i>
                        <span class="text-sm font-bold">أراضي</span>
                    </a>
                    <a href="#" class="flex flex-col items-center min-w-[80px] px-3 py-2 rounded-lg hover:bg-gray-100 transition-all">
                        <i class="fas fa-palace text-primary text-xl mb-1"></i>
                        <span class="text-sm font-bold">قصور</span>
                    </a>
                    <a href="#" class="flex flex-col items-center min-w-[80px] px-3 py-2 rounded-lg hover:bg-gray-100 transition-all">
                        <i class="fas fa-umbrella-beach text-primary text-xl mb-1"></i>
                        <span class="text-sm font-bold">استراحات</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content Container -->
        <div class="flex-grow">
            <!-- Home Page Content -->
            <div id="homePage" class="block">
                <!-- Hero Section -->
                <section class="relative">
                    <div class="h-96 w-full bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80');">
                        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
                        <div class="container mx-auto px-4 h-full flex items-center justify-center relative z-10">
                            <div class="text-center text-white">
                                <h2 class="text-4xl font-bold mb-4">ابحث عن منزل أحلامك</h2>
                                <p class="text-xl mb-6">نقدم لك أفضل العقارات في المملكة بأسعار مناسبة</p>
                                <button class="bg-accent hover:bg-opacity-80 text-white px-6 py-3 rounded-lg text-lg font-bold transition duration-300">استعراض العقارات</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Search Section -->
                <section class="py-8 bg-white shadow-md">
                    <div class="container mx-auto px-4">
                        <div class="max-w-4xl mx-auto">
                            <div class="bg-primary p-6 rounded-lg shadow-lg">
                                <h3 class="text-xl font-bold text-white mb-4">ابحث عن العقار المناسب</h3>
                                <div class="flex flex-wrap -mx-2">
                                    <div class="w-full md:w-1/4 px-2 mb-4">
                                        <select id="regionSelect" class="w-full p-3 rounded-lg">
                                            <option value="">اختر المنطقة</option>
                                            <option value="riyadh">الرياض</option>
                                            <option value="jeddah">جدة</option>
                                            <option value="makkah">مكة المكرمة</option>
                                            <option value="madinah">المدينة المنورة</option>
                                            <option value="taif">الطائف</option>
                                            <option value="dammam">الدمام</option>
                                            <option value="khobar">الخبر</option>
                                            <option value="abha">أبها</option>
                                            <option value="tabuk">تبوك</option>
                                            <option value="qassim">القصيم</option>
                                            <option value="hail">حائل</option>
                                            <option value="jazan">جازان</option>
                                            <option value="najran">نجران</option>
                                            <option value="custom">منطقة أخرى...</option>
                                        </select>
                                    </div>
                                    <div class="w-full md:w-1/4 px-2 mb-4" id="customRegionContainer" style="display: none;">
                                        <input type="text" id="customRegion" placeholder="اكتب اسم المنطقة" class="w-full p-3 rounded-lg">
                                    </div>
                                    <div class="w-full md:w-1/4 px-2 mb-4">
                                        <select id="propertyType" class="w-full p-3 rounded-lg">
                                            <option value="">نوع العقار</option>
                                            <option value="building">عمائر</option>
                                            <option value="villa">فلل</option>
                                            <option value="apartment">شقق</option>
                                            <option value="land">أراضي</option>
                                            <option value="palace">قصور</option>
                                            <option value="rest">استراحات</option>
                                            <option value="floor">دور</option>
                                        </select>
                                    </div>
                                    <div class="w-full md:w-1/4 px-2 mb-4">
                                        <select id="priceRange" class="w-full p-3 rounded-lg">
                                            <option value="">السعر (من - إلى)</option>
                                            <option value="100000-500000">100,000 - 500,000</option>
                                            <option value="500000-1000000">500,000 - 1,000,000</option>
                                            <option value="1000000-5000000">1,000,000 - 5,000,000</option>
                                            <option value="5000000+">أكثر من 5,000,000</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <button id="searchBtn" class="bg-accent hover:bg-opacity-80 text-white px-6 py-2 rounded-lg font-bold transition duration-300">
                                        <i class="fas fa-search ml-2"></i> بحث
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Category Section -->
                <section class="py-12">
                    <div class="container mx-auto px-4">
                        <div class="mb-10">
                            <h2 class="text-3xl font-bold text-center mb-8">تصفح حسب نوع العملية</h2>
                            <div class="flex flex-wrap justify-center gap-6">
                                <div class="bg-white shadow-lg rounded-lg p-6 w-full md:w-5/12 flex items-center justify-between cursor-pointer hover:shadow-xl transition duration-300" data-operation="sale">
                                    <div>
                                        <h3 class="text-2xl font-bold text-primary mb-2">بيع</h3>
                                        <p class="text-gray-600">اكتشف أفضل العقارات المعروضة للبيع</p>
                                    </div>
                                    <div class="bg-primary text-white w-16 h-16 rounded-full flex items-center justify-center text-3xl">
                                        <i class="fas fa-home"></i>
                                    </div>
                                </div>
                                <div class="bg-white shadow-lg rounded-lg p-6 w-full md:w-5/12 flex items-center justify-between cursor-pointer hover:shadow-xl transition duration-300" data-operation="rent">
                                    <div>
                                        <h3 class="text-2xl font-bold text-secondary mb-2">إيجار</h3>
                                        <p class="text-gray-600">تصفح العقارات المتاحة للإيجار</p>
                                    </div>
                                    <div class="bg-secondary text-white w-16 h-16 rounded-full flex items-center justify-center text-3xl">
                                        <i class="fas fa-key"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h2 class="text-3xl font-bold text-center mb-8">تصفح حسب نوع العقار</h2>
                            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-4">
                                <div class="text-center cursor-pointer" data-category="building">
                                    <div class="w-20 h-20 rounded-full bg-primary mx-auto flex items-center justify-center text-white text-2xl mb-2 hover:bg-secondary transition duration-300">
                                        <i class="fas fa-building"></i>
                                    </div>
                                    <h3 class="font-bold">عمائر</h3>
                                </div>
                                <div class="text-center cursor-pointer" data-category="villa">
                                    <div class="w-20 h-20 rounded-full bg-primary mx-auto flex items-center justify-center text-white text-2xl mb-2 hover:bg-secondary transition duration-300">
                                        <i class="fas fa-home"></i>
                                    </div>
                                    <h3 class="font-bold">فلل</h3>
                                </div>
                                <div class="text-center cursor-pointer" data-category="apartment">
                                    <div class="w-20 h-20 rounded-full bg-primary mx-auto flex items-center justify-center text-white text-2xl mb-2 hover:bg-secondary transition duration-300">
                                        <i class="fas fa-city"></i>
                                    </div>
                                    <h3 class="font-bold">شقق</h3>
                                </div>
                                <div class="text-center cursor-pointer" data-category="land">
                                    <div class="w-20 h-20 rounded-full bg-primary mx-auto flex items-center justify-center text-white text-2xl mb-2 hover:bg-secondary transition duration-300">
                                        <i class="fas fa-map"></i>
                                    </div>
                                    <h3 class="font-bold">أراضي</h3>
                                </div>
                                <div class="text-center cursor-pointer" data-category="rest">
                                    <div class="w-20 h-20 rounded-full bg-primary mx-auto flex items-center justify-center text-white text-2xl mb-2 hover:bg-secondary transition duration-300">
                                        <i class="fas fa-umbrella-beach"></i>
                                    </div>
                                    <h3 class="font-bold">استراحات</h3>
                                </div>
                                <div class="text-center cursor-pointer" data-category="floor">
                                    <div class="w-20 h-20 rounded-full bg-primary mx-auto flex items-center justify-center text-white text-2xl mb-2 hover:bg-secondary transition duration-300">
                                        <i class="fas fa-border-all"></i>
                                    </div>
                                    <h3 class="font-bold">دور</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Premium Services Section -->
                <section class="py-12 bg-white">
                    <div class="container mx-auto px-4">
                        <h2 class="text-3xl font-bold text-center mb-8">خدماتنا المميزة</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <!-- Quick Sale Service -->
                            <div class="bg-gradient-to-br from-primary to-secondary text-white rounded-xl shadow-lg overflow-hidden">
                                <div class="p-6">
                                    <div class="w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-3xl mb-4">
                                        <i class="fas fa-bolt"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold mb-3">البيع السريع</h3>
                                    <p class="mb-4">بيع عقارك بسرعة وبأفضل سعر من خلال شبكة واسعة من المشترين المحتملين</p>
                                    <button id="quickSaleBtn" class="bg-white text-primary hover:bg-opacity-90 px-4 py-2 rounded-lg font-bold transition duration-300">طلب بيع سريع</button>
                                </div>
                            </div>
                            
                            <!-- Certified Brokers -->
                            <div class="bg-gradient-to-br from-success to-secondary text-white rounded-xl shadow-lg overflow-hidden">
                                <div class="p-6">
                                    <div class="w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-3xl mb-4">
                                        <i class="fas fa-user-check"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold mb-3">وسطاء معتمدين</h3>
                                    <p class="mb-4">تعامل مع وسطاء عقاريين محترفين ومعتمدين من الهيئة العامة للعقار المنصة</p>
                                    <button id="certifiedBrokersBtn" class="bg-white text-success hover:bg-opacity-90 px-4 py-2 rounded-lg font-bold transition duration-300">تصفح الوسطاء</button>
                                </div>
                            </div>
                            
                            <!-- Financing Services -->
                            <div class="bg-gradient-to-br from-accent to-warning text-white rounded-xl shadow-lg overflow-hidden">
                                <div class="p-6">
                                    <div class="w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-3xl mb-4">
                                        <i class="fas fa-hand-holding-usd"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold mb-3">خدمات التمويل</h3>
                                    <p class="mb-4">احصل على أفضل عروض التمويل العقاري من البنوك وشركات التمويل المختلفة</p>
                                    <button id="financingBtn" class="bg-white text-accent hover:bg-opacity-90 px-4 py-2 rounded-lg font-bold transition duration-300">طلب تمويل</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Featured Properties -->
                <section class="py-12 bg-gray-100">
                    <div class="container mx-auto px-4">
                        <h2 class="text-3xl font-bold text-center mb-8">أحدث العقارات</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="propertiesContainer">
                            <!-- Property cards will be generated here -->
                        </div>
                        <div class="text-center mt-8">
                            <button id="loadMoreBtn" class="bg-secondary hover:bg-opacity-80 text-white px-8 py-3 rounded-lg font-bold transition duration-300">عرض المزيد</button>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Agent Dashboard (Hidden by default) -->
            <div id="agentDashboardPage" class="hidden">
                <div class="container mx-auto px-4 py-8">
                    <div class="mb-8 flex flex-wrap items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-primary">لوحة تحكم الوسيط</h1>
                            <p class="text-gray-600">إدارة العقارات والطلبات</p>
                        </div>
                        <button id="addPropertyBtn" class="bg-success hover:bg-opacity-80 text-white px-4 py-2 rounded-lg flex items-center transition duration-300">
                            <i class="fas fa-plus ml-2"></i> إضافة عقار جديد
                        </button>
                    </div>
                    
                    <!-- Tabs Container -->
                    <div class="mb-8">
                        <div class="flex border-b border-gray-200">
                            <button class="agent-tab-btn px-6 py-3 border-b-2 border-primary text-primary font-bold" data-tab="properties">العقارات</button>
                            <button class="agent-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="inquiries">الاستفسارات</button>
                            <button class="agent-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="statistics">الإحصائيات</button>
                        </div>
                    </div>
                    
                    <!-- Agent Tab Content: Properties -->
                    <div id="agentPropertiesTab" class="agent-tab-content block">
                        <div class="flex flex-wrap items-center justify-between mb-4">
                            <div class="w-full md:w-auto mb-4 md:mb-0">
                                <div class="flex items-center">
                                    <div class="relative">
                                        <input type="text" id="agentSearchProperty" placeholder="البحث عن عقار..." class="pr-10 pl-4 py-2 border border-gray-300 rounded-lg w-full md:w-64">
                                        <i class="fas fa-search absolute top-3 right-3 text-gray-400"></i>
                                    </div>
                                    <select id="agentPropertyFilter" class="mr-2 border border-gray-300 rounded-lg px-4 py-2">
                                        <option value="all">جميع العقارات</option>
                                        <option value="active">نشط</option>
                                        <option value="pending">قيد المراجعة</option>
                                        <option value="sold">تم البيع</option>
                                        <option value="inactive">غير نشط</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex space-x-2 space-x-reverse">
                                <button class="bg-gray-100 text-gray-600 hover:bg-gray-200 px-3 py-2 rounded-lg transition duration-300">
                                    <i class="fas fa-download ml-1"></i> تصدير
                                </button>
                                <button class="bg-gray-100 text-gray-600 hover:bg-gray-200 px-3 py-2 rounded-lg transition duration-300">
                                    <i class="fas fa-print ml-1"></i> طباعة
                                </button>
                            </div>
                        </div>
                        
                        <!-- Properties Table -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">العقار</th>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">النوع</th>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الموقع</th>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">السعر</th>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">المشاهدات</th>
                                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">إجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="agentPropertiesTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Properties will be loaded here dynamically -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Pagination -->
                        <div class="flex items-center justify-between mt-4">
                            <div class="text-sm text-gray-500">عرض <span id="agentPropertiesDisplayCount">1-10</span> من <span id="agentPropertiesTotal">50</span> عقار</div>
                            <div class="flex space-x-1 space-x-reverse">
                                <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition duration-300">السابق</button>
                                <button class="px-3 py-1 bg-primary text-white rounded-lg transition duration-300">1</button>
                                <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition duration-300">2</button>
                                <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition duration-300">3</button>
                                <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition duration-300">التالي</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Agent Tab Content: Inquiries -->
                    <div id="agentInquiriesTab" class="agent-tab-content hidden">
                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">استفسارات العملاء</h3>
                                <div id="agentInquiriesList" class="space-y-4">
                                    <!-- Inquiries will be loaded here dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Agent Tab Content: Statistics -->
                    <div id="agentStatisticsTab" class="agent-tab-content hidden">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <!-- Stat Card: Views -->
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 text-sm">إجمالي المشاهدات</p>
                                        <h4 class="text-3xl font-bold" id="totalPropertyViews">2,547</h4>
                                    </div>
                                    <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-500">
                                        <i class="fas fa-eye text-xl"></i>
                                    </div>
                                </div>
                                <div class="mt-4 flex items-center text-sm">
                                    <span class="text-green-500 flex items-center">
                                        <i class="fas fa-arrow-up ml-1"></i> 12%
                                    </span>
                                    <span class="text-gray-500 mr-2">من الشهر الماضي</span>
                                </div>
                            </div>
                            
                            <!-- Stat Card: Leads -->
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 text-sm">عدد الاتصالات</p>
                                        <h4 class="text-3xl font-bold" id="totalLeads">154</h4>
                                    </div>
                                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-500">
                                        <i class="fas fa-phone-alt text-xl"></i>
                                    </div>
                                </div>
                                <div class="mt-4 flex items-center text-sm">
                                    <span class="text-green-500 flex items-center">
                                        <i class="fas fa-arrow-up ml-1"></i> 8%
                                    </span>
                                    <span class="text-gray-500 mr-2">من الشهر الماضي</span>
                                </div>
                            </div>
                            
                            <!-- Stat Card: Sales -->
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 text-sm">العقارات المباعة</p>
                                        <h4 class="text-3xl font-bold" id="totalSales">12</h4>
                                    </div>
                                    <div class="w-12 h-12 rounded-full bg-accent bg-opacity-20 flex items-center justify-center text-accent">
                                        <i class="fas fa-check-circle text-xl"></i>
                                    </div>
                                </div>
                                <div class="mt-4 flex items-center text-sm">
                                    <span class="text-red-500 flex items-center">
                                        <i class="fas fa-arrow-down ml-1"></i> 3%
                                    </span>
                                    <span class="text-gray-500 mr-2">من الشهر الماضي</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chart Containers -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <h3 class="text-lg font-bold mb-4">مشاهدات العقارات</h3>
                                <div class="h-64 chart-container" id="propertyViewsChart">
                                    <!-- Chart will be rendered here -->
                                    <div class="flex items-center justify-center h-full">
                                        <p class="text-gray-500">يرجى انتظار تحميل الرسم البياني...</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <h3 class="text-lg font-bold mb-4">أنواع العقارات المعروضة</h3>
                                <div class="h-64 chart-container" id="propertyTypesChart">
                                    <!-- Chart will be rendered here -->
                                    <div class="flex items-center justify-center h-full">
                                        <p class="text-gray-500">يرجى انتظار تحميل الرسم البياني...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Admin Dashboard (Hidden by default) -->
            <div id="adminDashboardPage" class="hidden">
                <div class="container mx-auto px-4 py-8">
                    <div class="mb-8 flex flex-wrap items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-primary">لوحة تحكم المشرف</h1>
                            <p class="text-gray-600">إدارة المنصة والتحكم بالمستخدمين والعقارات</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button id="adminThemeBtn2" class="bg-secondary hover:bg-opacity-80 text-white px-4 py-2 rounded-lg flex items-center transition duration-300">
                                <i class="fas fa-palette ml-2"></i> تخصيص التصميم
                            </button>
                            <button id="adminSettingsBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg flex items-center transition duration-300">
                                <i class="fas fa-cog ml-2"></i> الإعدادات
                            </button>
                        </div>
                    </div>
                    
                    <!-- Admin Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow-md p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">إجمالي المستخدمين</p>
                                    <h4 class="text-3xl font-bold" id="totalUsers">1,243</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-primary bg-opacity-20 flex items-center justify-center text-primary">
                                    <i class="fas fa-users text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow-md p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">إجمالي العقارات</p>
                                    <h4 class="text-3xl font-bold" id="totalProperties">384</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-secondary bg-opacity-20 flex items-center justify-center text-secondary">
                                    <i class="fas fa-home text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow-md p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">طلبات الموافقة</p>
                                    <h4 class="text-3xl font-bold" id="pendingApprovals">26</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-warning bg-opacity-20 flex items-center justify-center text-warning">
                                    <i class="fas fa-exclamation-circle text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow-md p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">الزيارات اليومية</p>
                                    <h4 class="text-3xl font-bold" id="dailyVisits">587</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-success bg-opacity-20 flex items-center justify-center text-success">
                                    <i class="fas fa-chart-line text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Tabs -->
                    <div class="mb-8">
                        <div class="flex border-b border-gray-200 overflow-x-auto whitespace-nowrap">
                            <button class="admin-tab-btn px-6 py-3 border-b-2 border-primary text-primary font-bold" data-tab="dashboard">الرئيسية</button>
                            <button class="admin-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="users">المستخدمين</button>
                            <button class="admin-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="properties">العقارات</button>
                            <button class="admin-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="agents">الوسطاء</button>
                            <button class="admin-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="reports">التقارير</button>
                            <button class="admin-tab-btn px-6 py-3 border-b-2 border-transparent hover:text-primary" data-tab="templates">قوالب الموقع</button>
                        </div>
                    </div>
                    
                    <!-- Admin Tab Content: Dashboard -->
                    <div id="adminDashboardTab" class="admin-tab-content block">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="lg:col-span-2 bg-white rounded-lg shadow-md p-6">
                                <h3 class="text-lg font-bold mb-4">نشاط الموقع</h3>
                                <div class="h-80 chart-container" id="siteActivityChart">
                                    <!-- Chart will be rendered here -->
                                    <div class="flex items-center justify-center h-full">
                                        <p class="text-gray-500">يرجى انتظار تحميل الرسم البياني...</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="lg:col-span-1 space-y-6">
                                <div class="bg-white rounded-lg shadow-md p-6">
                                    <h3 class="text-lg font-bold mb-4">التنبيهات الأخيرة</h3>
                                    <div class="space-y-4" id="recentAlertsContainer">
                                        <div class="flex items-start">
                                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-warning bg-opacity-20 flex items-center justify-center text-warning mr-2">
                                                <i class="fas fa-user-plus"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm">مستخدم جديد سجل في المنصة</p>
                                                <p class="text-xs text-gray-500">منذ 5 دقائق</p>
                                            </div>
                                        </div>
                                        <div class="flex items-start">
                                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-success bg-opacity-20 flex items-center justify-center text-success mr-2">
                                                <i class="fas fa-home"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm">تمت إضافة عقار جديد</p>
                                                <p class="text-xs text-gray-500">منذ 18 دقيقة</p>
                                            </div>
                                        </div>
                                        <div class="flex items-start">
                                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-accent bg-opacity-20 flex items-center justify-center text-accent mr-2">
                                                <i class="fas fa-flag"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm">تم الإبلاغ عن محتوى</p>
                                                <p class="text-xs text-gray-500">منذ 42 دقيقة</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-white rounded-lg shadow-md p-6">
                                    <h3 class="text-lg font-bold mb-4">قوالب الموقع المتاحة</h3>
                                    <div class="space-y-3" id="siteTemplatesContainer">
                                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                            <div class="flex items-center">
                                                <div class="w-8 h-8 bg-primary rounded-md mr-2"></div>
                                                <span>القالب الافتراضي</span>
                                            </div>
                                            <div class="text-xs bg-success bg-opacity-10 text-success px-2 py-1 rounded">نشط</div>
                                        </div>
                                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                            <div class="flex items-center">
                                                <div class="w-8 h-8 bg-blue-800 rounded-md mr-2"></div>
                                                <span>قالب داكن</span>
                                            </div>
                                            <div class="text-xs bg-gray-100 text-gray-500 px-2 py-1 rounded">تفعيل</div>
                                        </div>
                                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                            <div class="flex items-center">
                                                <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-md mr-2"></div>
                                                <span>قالب عصري</span>
                                            </div>
                                            <div class="text-xs bg-gray-100 text-gray-500 px-2 py-1 rounded">تفعيل</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Tab Content: Users (Hidden by default) -->
                    <div id="adminUsersTab" class="admin-tab-content hidden">
                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">إدارة المستخدمين</h3>
                                <!-- Add more user management content here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Tab Content: Properties, Agents, Reports, Templates (Hidden by default) -->
                    <div id="adminPropertiesTab" class="admin-tab-content hidden">
                        <!-- Property Management Content -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">إدارة العقارات</h3>
                                <div class="flex flex-wrap items-center justify-between mb-4">
                                    <div class="w-full md:w-auto mb-4 md:mb-0">
                                        <div class="flex items-center">
                                            <div class="relative">
                                                <input type="text" id="adminSearchProperty" placeholder="البحث عن عقار..." class="pr-10 pl-4 py-2 border border-gray-300 rounded-lg w-full md:w-64">
                                                <i class="fas fa-search absolute top-3 right-3 text-gray-400"></i>
                                            </div>
                                            <select id="adminPropertyFilter" class="mr-2 border border-gray-300 rounded-lg px-4 py-2">
                                                <option value="all">جميع العقارات</option>
                                                <option value="active">نشط</option>
                                                <option value="pending">قيد المراجعة</option>
                                                <option value="sold">تم البيع</option>
                                                <option value="inactive">غير نشط</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <button id="adminAddPropertyBtn" class="bg-success hover:bg-opacity-80 text-white px-4 py-2 rounded-lg flex items-center transition duration-300">
                                            <i class="fas fa-plus ml-2"></i> إضافة عقار جديد
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Properties Table -->
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">العقار</th>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">النوع</th>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الموقع</th>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">السعر</th>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الوسيط</th>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">إجراءات</th>
                                            </tr>
                                        </thead>
                                        <tbody id="adminPropertiesTableBody" class="bg-white divide-y divide-gray-200">
                                            <!-- Properties will be loaded here dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="adminAgentsTab" class="admin-tab-content hidden">
                        <!-- Agents Management Content -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">إدارة الوسطاء</h3>
                                <!-- Agents management interface -->
                            </div>
                        </div>
                    </div>
                    
                    <div id="adminReportsTab" class="admin-tab-content hidden">
                        <!-- Reports Content -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">التقارير</h3>
                                <!-- Reports content -->
                            </div>
                        </div>
                    </div>
                    
                    <div id="adminTemplatesTab" class="admin-tab-content hidden">
                        <!-- Site Templates Content -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">قوالب الموقع</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <!-- Template Card: Default -->
                                    <div class="border rounded-lg overflow-hidden hover:shadow-lg transition duration-300">
                                        <div class="h-40 bg-gradient-to-r from-primary to-secondary relative">
                                            <div class="absolute top-2 right-2 bg-success text-white text-xs px-2 py-1 rounded">نشط</div>
                                        </div>
                                        <div class="p-4">
                                            <h4 class="font-bold mb-2">القالب الافتراضي</h4>
                                            <p class="text-gray-600 text-sm mb-4">القالب الرئيسي للموقع بتصميم حديث وألوان متناسقة</p>
                                            <button class="w-full bg-primary text-white p-2 rounded-lg hover:bg-opacity-80 transition duration-300">تخصيص</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Template Card: Dark -->
                                    <div class="border rounded-lg overflow-hidden hover:shadow-lg transition duration-300">
                                        <div class="h-40 bg-gradient-to-r from-gray-800 to-gray-900 relative">
                                            <div class="absolute top-2 right-2 bg-gray-600 text-white text-xs px-2 py-1 rounded">متاح</div>
                                        </div>
                                        <div class="p-4">
                                            <h4 class="font-bold mb-2">القالب الداكن</h4>
                                            <p class="text-gray-600 text-sm mb-4">تصميم داكن مع ألوان مميزة، مناسب للعرض الليلي</p>
                                            <button class="w-full bg-gray-200 text-gray-800 p-2 rounded-lg hover:bg-gray-300 transition duration-300">تفعيل</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Template Card: Modern -->
                                    <div class="border rounded-lg overflow-hidden hover:shadow-lg transition duration-300">
                                        <div class="h-40 bg-gradient-to-r from-purple-500 to-pink-500 relative">
                                            <div class="absolute top-2 right-2 bg-gray-600 text-white text-xs px-2 py-1 rounded">متاح</div>
                                        </div>
                                        <div class="p-4">
                                            <h4 class="font-bold mb-2">القالب العصري</h4>
                                            <p class="text-gray-600 text-sm mb-4">تصميم عصري مع ألوان جريئة وتأثيرات حديثة</p>
                                            <button class="w-full bg-gray-200 text-gray-800 p-2 rounded-lg hover:bg-gray-300 transition duration-300">تفعيل</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Property Details Page (Hidden by default) -->
            <div id="propertyDetailsPage" class="hidden">
                <div class="container mx-auto px-4 py-8">
                    <button id="backToHomeBtn" class="bg-primary text-white px-4 py-2 rounded-lg mb-6 hover:bg-opacity-80 transition duration-300">
                        <i class="fas fa-arrow-right ml-2"></i> العودة للرئيسية
                    </button>
                    
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                        <div class="property-carousel carousel mb-6">
                            <div class="carousel-inner" id="propertyCarousel">
                                <!-- Carousel images will be generated here -->
                            </div>
                            <button class="carousel-control-prev absolute top-1/2 right-4 transform -translate-y-1/2 bg-black bg-opacity-50 w-10 h-10 rounded-full flex items-center justify-center text-white">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <button class="carousel-control-next absolute top-1/2 left-4 transform -translate-y-1/2 bg-black bg-opacity-50 w-10 h-10 rounded-full flex items-center justify-center text-white">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                        </div>
                        
                        <div class="thumbnail-container flex overflow-x-auto space-x-2 space-x-reverse mb-6 px-4" id="thumbnailContainer">
                            <!-- Thumbnail images will be generated here -->
                        </div>
                        
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h1 id="propertyTitle" class="text-3xl font-bold"></h1>
                                <div id="propertyPrice" class="text-2xl font-bold text-secondary"></div>
                            </div>
                            
                            <div class="flex items-center text-gray-600 mb-6">
                                <i class="fas fa-map-marker-alt ml-2"></i>
                                <span id="propertyLocation"></span>
                            </div>
                            
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6" id="propertyFeatures">
                                <!-- Property features will be generated here -->
                            </div>
                            
                            <div class="mb-6">
                                <h2 class="text-2xl font-bold mb-4">الوصف</h2>
                                <p id="propertyDescription" class="text-gray-700 leading-relaxed"></p>
                            </div>
                            
                            <div class="mb-6">
                                <h2 class="text-2xl font-bold mb-4">المميزات</h2>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="propertyAmenities">
                                    <!-- Property amenities will be generated here -->
                                </div>
                            </div>
                            
                            <div class="border-t pt-6">
                                <a id="whatsappLink" href="#" class="block bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg text-center transition duration-300">
                                    <i class="fab fa-whatsapp ml-2 text-xl"></i>
                                    تواصل مع المسوق العقاري
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Login Form (Hidden by default) -->
            <div id="loginForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">تسجيل الدخول</h2>
                        <button id="closeLoginBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="loginFormContent">
                        <div class="mb-4">
                            <label for="username" class="block text-gray-700 mb-2">اسم المستخدم</label>
                            <input type="text" id="username" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل اسم المستخدم">
                        </div>
                        <div class="mb-6">
                            <label for="password" class="block text-gray-700 mb-2">كلمة المرور</label>
                            <input type="password" id="password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل كلمة المرور">
                        </div>
                        <div id="loginError" class="hidden text-red-500 mb-4">اسم المستخدم أو كلمة المرور غير صحيحة</div>
                        <button type="submit" class="w-full bg-primary hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            دخول
                        </button>
                    </form>
                </div>
            </div>

            <!-- Register Form (Hidden by default) -->
            <div id="registerForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">تسجيل وسيط عقاري جديد</h2>
                        <button id="closeRegisterBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="registerFormContent">
                        <div class="mb-4">
                            <label for="fullName" class="block text-gray-700 mb-2">الاسم الكامل</label>
                            <input type="text" id="fullName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل الاسم الكامل">
                        </div>
                        <div class="mb-4">
                            <label for="registerUsername" class="block text-gray-700 mb-2">اسم المستخدم</label>
                            <input type="text" id="registerUsername" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل اسم المستخدم">
                        </div>
                        <div class="mb-4">
                            <label for="email" class="block text-gray-700 mb-2">البريد الإلكتروني</label>
                            <input type="email" id="email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل البريد الإلكتروني">
                        </div>
                        <div class="mb-4">
                            <label for="phone" class="block text-gray-700 mb-2">رقم الجوال</label>
                            <input type="text" id="phone" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل رقم الجوال">
                        </div>
                        <div class="mb-4">
                            <label for="licenseNumber" class="block text-gray-700 mb-2">رقم الترخيص</label>
                            <input type="text" id="licenseNumber" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل رقم ترخيص الوساطة العقارية">
                        </div>
                        <div class="mb-4">
                            <label for="registerPassword" class="block text-gray-700 mb-2">كلمة المرور</label>
                            <input type="password" id="registerPassword" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل كلمة المرور">
                        </div>
                        <div class="mb-6">
                            <label for="confirmPassword" class="block text-gray-700 mb-2">تأكيد كلمة المرور</label>
                            <input type="password" id="confirmPassword" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أعد إدخال كلمة المرور">
                        </div>
                        <div id="registerError" class="hidden text-red-500 mb-4">حدث خطأ في عملية التسجيل</div>
                        <button type="submit" class="w-full bg-accent hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            تسجيل
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Add Property Form (Hidden by default) -->
            <div id="addPropertyForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl p-6 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary">إضافة عقار جديد</h2>
                        <button id="closeAddPropertyBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="addPropertyFormContent">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label for="propertyTitle" class="block text-gray-700 mb-2">عنوان العقار</label>
                                <input type="text" id="propertyTitle" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: فيلا فاخرة في شمال الرياض">
                            </div>
                            <div>
                                <label for="propertyType" class="block text-gray-700 mb-2">نوع العقار</label>
                                <select id="propertyType" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                    <option value="">اختر نوع العقار</option>
                                    <option value="building">عمارة</option>
                                    <option value="villa">فيلا</option>
                                    <option value="apartment">شقة</option>
                                    <option value="land">أرض</option>
                                    <option value="rest">استراحة</option>
                                    <option value="floor">دور</option>
                                </select>
                            </div>
                            <div>
                                <label for="propertyOperation" class="block text-gray-700 mb-2">نوع العملية</label>
                                <select id="propertyOperation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                    <option value="">اختر نوع العملية</option>
                                    <option value="sale">بيع</option>
                                    <option value="rent">إيجار</option>
                                </select>
                            </div>
                            <div>
                                <label for="propertyPrice" class="block text-gray-700 mb-2">السعر</label>
                                <input type="number" id="propertyPrice" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل السعر بالريال السعودي">
                            </div>
                            <div>
                                <label for="propertyCity" class="block text-gray-700 mb-2">المدينة</label>
                                <input type="text" id="propertyCity" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: الرياض">
                            </div>
                            <div>
                                <label for="propertyDistrict" class="block text-gray-700 mb-2">الحي</label>
                                <input type="text" id="propertyDistrict" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: حي النرجس">
                            </div>
                            <div>
                                <label for="propertySize" class="block text-gray-700 mb-2">المساحة (متر مربع)</label>
                                <input type="number" id="propertySize" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل المساحة بالمتر المربع">
                            </div>
                            <div>
                                <label for="propertyBedrooms" class="block text-gray-700 mb-2">عدد غرف النوم</label>
                                <input type="number" id="propertyBedrooms" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: 3">
                            </div>
                            <div>
                                <label for="propertyBathrooms" class="block text-gray-700 mb-2">عدد دورات المياه</label>
                                <input type="number" id="propertyBathrooms" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: 2">
                            </div>
                            <div>
                                <label for="propertyAge" class="block text-gray-700 mb-2">عمر العقار (بالسنوات)</label>
                                <input type="number" id="propertyAge" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: 5">
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label for="propertyDescription" class="block text-gray-700 mb-2">وصف العقار</label>
                            <textarea id="propertyDescription" rows="5" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="قم بوصف العقار بالتفصيل..."></textarea>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">المميزات</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature1" class="ml-2">
                                    <label for="feature1">مسبح</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature2" class="ml-2">
                                    <label for="feature2">مصعد</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature3" class="ml-2">
                                    <label for="feature3">موقف سيارات</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature4" class="ml-2">
                                    <label for="feature4">تكييف مركزي</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature5" class="ml-2">
                                    <label for="feature5">مطبخ مجهز</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature6" class="ml-2">
                                    <label for="feature6">حديقة</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature7" class="ml-2">
                                    <label for="feature7">غرفة خادمة</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="feature8" class="ml-2">
                                    <label for="feature8">قريب من الخدمات</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">صور العقار</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                                <input type="file" id="propertyImages" class="hidden" multiple accept="image/*">
                                <label for="propertyImages" class="block cursor-pointer">
                                    <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                                    <p class="text-gray-500">اضغط لإضافة صور أو اسحب الصور إلى هنا</p>
                                    <p class="text-xs text-gray-400 mt-2">الحد الأقصى: 10 صور</p>
                                </label>
                            </div>
                            <div id="imagePreviewContainer" class="flex flex-wrap mt-3 gap-2">
                                <!-- Image previews will appear here -->
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label for="propertyLocation" class="block text-gray-700 mb-2">الموقع على الخريطة</label>
                            <div class="h-56 bg-gray-200 rounded-lg flex items-center justify-center">
                                <p class="text-gray-500">سيتم إضافة خريطة لتحديد الموقع</p>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label for="propertyAgent" class="block text-gray-700 mb-2">معلومات الاتصال</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <input type="text" id="agentName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="اسم الوسيط">
                                </div>
                                <div>
                                    <input type="text" id="agentPhone" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="رقم الجوال">
                                </div>
                                <div class="md:col-span-2">
                                    <input type="email" id="agentEmail" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="البريد الإلكتروني">
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-2 space-x-reverse">
                            <button type="button" id="cancelAddProperty" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-300">إلغاء</button>
                            <button type="submit" class="px-6 py-2 bg-success text-white rounded-lg hover:bg-opacity-80 transition duration-300">حفظ العقار</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Edit Property Form (Hidden by default) -->
            <div id="editPropertyForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl p-6 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary">تعديل العقار</h2>
                        <button id="closeEditPropertyBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="editPropertyFormContent">
                        <input type="hidden" id="editPropertyId">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label for="editPropertyTitle" class="block text-gray-700 mb-2">عنوان العقار</label>
                                <input type="text" id="editPropertyTitle" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: فيلا فاخرة في شمال الرياض">
                            </div>
                            <div>
                                <label for="editPropertyType" class="block text-gray-700 mb-2">نوع العقار</label>
                                <select id="editPropertyType" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                    <option value="">اختر نوع العقار</option>
                                    <option value="building">عمارة</option>
                                    <option value="villa">فيلا</option>
                                    <option value="apartment">شقة</option>
                                    <option value="land">أرض</option>
                                    <option value="rest">استراحة</option>
                                    <option value="floor">دور</option>
                                </select>
                            </div>
                            <div>
                                <label for="editPropertyOperation" class="block text-gray-700 mb-2">نوع العملية</label>
                                <select id="editPropertyOperation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                    <option value="">اختر نوع العملية</option>
                                    <option value="sale">بيع</option>
                                    <option value="rent">إيجار</option>
                                </select>
                            </div>
                            <div>
                                <label for="editPropertyPrice" class="block text-gray-700 mb-2">السعر</label>
                                <input type="number" id="editPropertyPrice" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل السعر بالريال السعودي">
                            </div>
                            <div>
                                <label for="editPropertyCity" class="block text-gray-700 mb-2">المدينة</label>
                                <input type="text" id="editPropertyCity" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: الرياض">
                            </div>
                            <div>
                                <label for="editPropertyDistrict" class="block text-gray-700 mb-2">الحي</label>
                                <input type="text" id="editPropertyDistrict" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: حي النرجس">
                            </div>
                            <div>
                                <label for="editPropertySize" class="block text-gray-700 mb-2">المساحة (متر مربع)</label>
                                <input type="number" id="editPropertySize" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل المساحة بالمتر المربع">
                            </div>
                            <div>
                                <label for="editPropertyBedrooms" class="block text-gray-700 mb-2">عدد غرف النوم</label>
                                <input type="number" id="editPropertyBedrooms" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: 3">
                            </div>
                            <div>
                                <label for="editPropertyBathrooms" class="block text-gray-700 mb-2">عدد دورات المياه</label>
                                <input type="number" id="editPropertyBathrooms" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: 2">
                            </div>
                            <div>
                                <label for="editPropertyAge" class="block text-gray-700 mb-2">عمر العقار (بالسنوات)</label>
                                <input type="number" id="editPropertyAge" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="مثال: 5">
                            </div>
                            <div>
                                <label for="editPropertyStatus" class="block text-gray-700 mb-2">حالة العقار</label>
                                <select id="editPropertyStatus" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                    <option value="active">نشط</option>
                                    <option value="pending">قيد المراجعة</option>
                                    <option value="sold">تم البيع</option>
                                    <option value="inactive">غير نشط</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label for="editPropertyDescription" class="block text-gray-700 mb-2">وصف العقار</label>
                            <textarea id="editPropertyDescription" rows="5" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="قم بوصف العقار بالتفصيل..."></textarea>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">المميزات</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature1" class="ml-2">
                                    <label for="editFeature1">مسبح</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature2" class="ml-2">
                                    <label for="editFeature2">مصعد</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature3" class="ml-2">
                                    <label for="editFeature3">موقف سيارات</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature4" class="ml-2">
                                    <label for="editFeature4">تكييف مركزي</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature5" class="ml-2">
                                    <label for="editFeature5">مطبخ مجهز</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature6" class="ml-2">
                                    <label for="editFeature6">حديقة</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature7" class="ml-2">
                                    <label for="editFeature7">غرفة خادمة</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="editFeature8" class="ml-2">
                                    <label for="editFeature8">قريب من الخدمات</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">صور العقار</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                                <input type="file" id="editPropertyImages" class="hidden" multiple accept="image/*">
                                <label for="editPropertyImages" class="block cursor-pointer">
                                    <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                                    <p class="text-gray-500">اضغط لإضافة صور أو اسحب الصور إلى هنا</p>
                                    <p class="text-xs text-gray-400 mt-2">الحد الأقصى: 10 صور</p>
                                </label>
                            </div>
                            <div id="editImagePreviewContainer" class="flex flex-wrap mt-3 gap-2">
                                <!-- Image previews will appear here -->
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-2 space-x-reverse">
                            <button type="button" id="cancelEditProperty" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-300">إلغاء</button>
                            <button type="submit" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-80 transition duration-300">تحديث العقار</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Delete Property Confirmation (Hidden by default) -->
            <div id="deletePropertyConfirm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4">
                            <i class="fas fa-exclamation-triangle text-red-500 text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">تأكيد الحذف</h2>
                        <p class="text-gray-600">هل أنت متأكد من رغبتك في حذف هذا العقار؟ هذا الإجراء لا يمكن التراجع عنه.</p>
                    </div>
                    <div class="flex justify-center space-x-3 space-x-reverse">
                        <button id="cancelDeleteProperty" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-300">إلغاء</button>
                        <button id="confirmDeleteProperty" class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-300">حذف العقار</button>
                    </div>
                </div>
            </div>
            
            <!-- Theme Customization (Hidden by default) -->
            <div id="themeCustomizationForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl p-6 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary">تخصيص تصميم الموقع</h2>
                        <button id="closeThemeBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="md:col-span-2">
                            <form id="themeForm">
                                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                                    <h3 class="text-lg font-bold mb-3">الألوان الرئيسية</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label for="primaryColor" class="block text-gray-700 mb-2">اللون الرئيسي</label>
                                            <div class="flex">
                                                <input type="color" id="primaryColor" class="h-10 w-16">
                                                <input type="text" id="primaryColorText" class="w-full mr-2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="#123456">
                                            </div>
                                        </div>
                                        <div>
                                            <label for="secondaryColor" class="block text-gray-700 mb-2">اللون الثانوي</label>
                                            <div class="flex">
                                                <input type="color" id="secondaryColor" class="h-10 w-16">
                                                <input type="text" id="secondaryColorText" class="w-full mr-2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="#123456">
                                            </div>
                                        </div>
                                        <div>
                                            <label for="accentColor" class="block text-gray-700 mb-2">لون التأكيد</label>
                                            <div class="flex">
                                                <input type="color" id="accentColor" class="h-10 w-16">
                                                <input type="text" id="accentColorText" class="w-full mr-2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="#123456">
                                            </div>
                                        </div>
                                        <div>
                                            <label for="successColor" class="block text-gray-700 mb-2">لون النجاح</label>
                                            <div class="flex">
                                                <input type="color" id="successColor" class="h-10 w-16">
                                                <input type="text" id="successColorText" class="w-full mr-2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="#123456">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                                    <h3 class="text-lg font-bold mb-3">الشعار</h3>
                                    <div class="mb-4">
                                        <label for="logoUpload" class="block text-gray-700 mb-2">تحميل شعار جديد</label>
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                                            <input type="file" id="logoUpload" class="hidden" accept="image/*">
                                            <label for="logoUpload" class="block cursor-pointer">
                                                <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                                                <p class="text-gray-500">اضغط لإضافة شعار أو اسحب الصورة إلى هنا</p>
                                                <p class="text-xs text-gray-400 mt-2">PNG أو SVG بخلفية شفافة</p>
                                            </label>
                                        </div>
                                        <div id="logoPreview" class="mt-3 flex justify-center">
                                            <!-- Logo preview will appear here -->
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <label for="siteName" class="block text-gray-700 mb-2">اسم الموقع</label>
                                        <input type="text" id="siteName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="اسم المنصة العقارية">
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                                    <h3 class="text-lg font-bold mb-3">الخطوط والأنماط</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="fontFamily" class="block text-gray-700 mb-2">نوع الخط</label>
                                            <select id="fontFamily" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                                <option value="cairo">Cairo</option>
                                                <option value="tajawal">Tajawal</option>
                                                <option value="changa">Changa</option>
                                                <option value="almarai">Almarai</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label for="borderRadius" class="block text-gray-700 mb-2">زوايا العناصر</label>
                                            <select id="borderRadius" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                                                <option value="0">مربعة</option>
                                                <option value="4">منحنية قليلا</option>
                                                <option value="8">منحنية</option>
                                                <option value="16">منحنية بشكل كبير</option>
                                                <option value="24">دائرية</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-end space-x-2 space-x-reverse">
                                    <button type="button" id="resetTheme" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-300">استعادة الافتراضي</button>
                                    <button type="submit" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-80 transition duration-300">حفظ التغييرات</button>
                                </div>
                            </form>
                        </div>
                        <div>
                            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                                <h3 class="text-lg font-bold mb-3">معاينة</h3>
                                <div class="bg-white border rounded-lg overflow-hidden shadow-sm">
                                    <div id="previewHeader" class="bg-primary p-4 text-white">
                                        <div class="flex items-center">
                                            <div id="previewLogo" class="w-8 h-8 bg-white rounded-md flex items-center justify-center mr-2 text-primary font-bold">A</div>
                                            <div id="previewSiteName">العتيبي العقارية</div>
                                        </div>
                                    </div>
                                    <div class="p-4">
                                        <div class="mb-4">
                                            <div id="previewHeading" class="font-bold text-lg mb-2">عنوان رئيسي</div>
                                            <div class="bg-gray-200 h-2 rounded-full mb-2"></div>
                                            <div class="bg-gray-200 h-2 rounded-full mb-2 w-5/6"></div>
                                            <div class="bg-gray-200 h-2 rounded-full w-4/6"></div>
                                        </div>
                                        <div class="mb-4">
                                            <div id="previewButton1" class="bg-secondary text-white text-center py-2 px-4 rounded mb-2">زر رئيسي</div>
                                            <div id="previewButton2" class="bg-accent text-white text-center py-2 px-4 rounded">زر ثانوي</div>
                                        </div>
                                        <div class="flex space-x-2 space-x-reverse">
                                            <div id="previewCard1" class="w-2/6 bg-gray-100 rounded p-2">
                                                <div class="bg-primary h-12 rounded mb-2"></div>
                                                <div class="bg-gray-200 h-2 rounded-full mb-1"></div>
                                                <div class="bg-gray-200 h-2 rounded-full w-4/5"></div>
                                            </div>
                                            <div id="previewCard2" class="w-2/6 bg-gray-100 rounded p-2">
                                                <div class="bg-secondary h-12 rounded mb-2"></div>
                                                <div class="bg-gray-200 h-2 rounded-full mb-1"></div>
                                                <div class="bg-gray-200 h-2 rounded-full w-4/5"></div>
                                            </div>
                                            <div id="previewCard3" class="w-2/6 bg-gray-100 rounded p-2">
                                                <div class="bg-accent h-12 rounded mb-2"></div>
                                                <div class="bg-gray-200 h-2 rounded-full mb-1"></div>
                                                <div class="bg-gray-200 h-2 rounded-full w-4/5"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Toast Notification (Hidden by default) -->
            <div id="toastNotification" class="hidden fixed bottom-4 right-4 bg-white rounded-lg shadow-lg p-4 max-w-md transform transition-transform duration-300 z-50 flex items-center">
                <div id="toastIcon" class="flex-shrink-0 w-10 h-10 rounded-full bg-success flex items-center justify-center mr-3">
                    <i id="toastIconInner" class="fas fa-check text-white"></i>
                </div>
                <div class="flex-grow">
                    <h4 id="toastTitle" class="font-bold">تم بنجاح</h4>
                    <p id="toastMessage" class="text-gray-600">تم حفظ التغييرات بنجاح</p>
                </div>
                <button id="closeToast" class="text-gray-400 hover:text-gray-600 mr-2">
                    <i class="fas fa-times"></i>
                </button>
            </div>placeholder="5xxxxxxxx" required pattern="[0-9]{9}">
                            </div>
                        </div>
                        <div class="mb-6">
                            <label for="licenseNumber" class="block text-gray-700 mb-2">رقم رخصة الوساطة العقارية</label>
                            <input type="text" id="licenseNumber" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل رقم الرخصة" required>
                        </div>
                        <button type="submit" class="w-full bg-primary hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            تسجيل
                        </button>
                    </form>
                </div>
            </div>

            <!-- Registration Success Modal (Hidden by default) -->
            <div id="registrationSuccess" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                    <div class="text-center mb-6">
                        <div class="text-success text-5xl mb-4">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2">تم تسجيل طلبك بنجاح</h2>
                        <p class="text-gray-600">تم إرسال طلب التسجيل الخاص بك وهو الآن قيد المراجعة. سيتم إعلامك عند الموافقة عليه.</p>
                    </div>
                    <button id="closeSuccessBtn" class="w-full bg-primary hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        حسناً
                    </button>
                </div>
            </div>

            <!-- Admin Dashboard (Hidden by default) -->
            <div id="adminDashboard" class="hidden">
                <div class="bg-gray-100 min-h-screen">
                    <nav class="bg-primary text-white shadow-md">
                        <div class="container mx-auto px-4">
                            <div class="flex items-center justify-between py-4">
                                <div class="flex items-center">
                                    <h1 class="text-xl font-bold">لوحة تحكم المدير</h1>
                                </div>
                                <div class="flex items-center space-x-2 space-x-reverse">
                                    <button id="adminThemeBtn" class="bg-secondary hover:bg-opacity-80 px-4 py-2 rounded-lg text-sm transition duration-300 ml-2">
                                        <i class="fas fa-palette ml-1"></i> إعدادات التصميم
                                    </button>
                                    <button id="adminLogoutBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg text-sm transition duration-300">
                                        <i class="fas fa-sign-out-alt ml-1"></i> تسجيل خروج
                                    </button>
                                </div>
                            </div>
                        </div>
                    </nav>

                    <div class="container mx-auto px-4 py-8">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center">
                                    <div class="bg-primary bg-opacity-20 p-3 rounded-full ml-4">
                                        <i class="fas fa-building text-primary text-xl"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm text-gray-500">إجمالي العقارات</div>
                                        <div class="text-2xl font-bold" id="totalProperties">0</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center">
                                    <div class="bg-secondary bg-opacity-20 p-3 rounded-full ml-4">
                                        <i class="fas fa-users text-secondary text-xl"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm text-gray-500">الوسطاء المعتمدين</div>
                                        <div class="text-2xl font-bold" id="totalAgents">0</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center">
                                    <div class="bg-success bg-opacity-20 p-3 rounded-full ml-4">
                                        <i class="fas fa-gavel text-success text-xl"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm text-gray-500">المحامين المعتمدين</div>
                                        <div class="text-2xl font-bold" id="totalLawyers">0</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center">
                                    <div class="bg-accent bg-opacity-20 p-3 rounded-full ml-4">
                                        <i class="fas fa-chart-line text-accent text-xl"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm text-gray-500">زوار اليوم</div>
                                        <div class="text-2xl font-bold" id="adminVisitorCount">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- System Settings Section -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
                            <div class="px-6 py-4 border-b">
                                <h2 class="text-xl font-bold">إعدادات النظام</h2>
                            </div>
                            <div class="p-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Platform Settings -->
                                    <div class="space-y-4">
                                        <h3 class="text-lg font-bold mb-2">إعدادات المنصة</h3>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">اسم المنصة</label>
                                            <div class="flex">
                                                <input type="text" id="siteName" class="flex-grow p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" value="النخبة العقارية">
                                                <button id="saveSiteNameBtn" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300 mr-2">
                                                    <i class="fas fa-save ml-1"></i> حفظ
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">شعار المنصة</label>
                                            <div class="border border-dashed border-gray-300 rounded-lg p-6 text-center" id="logoUploadArea">
                                                <div id="logoPreviewContainer" class="mb-4 flex items-center justify-center">
                                                    <div id="logoPreview" class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center">
                                                        <i class="fas fa-building text-4xl text-gray-400"></i>
                                                    </div>
                                                </div>
                                                <label for="logoUpload" class="cursor-pointer">
                                                    <div class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300 inline-block">
                                                        <i class="fas fa-upload ml-1"></i> تحميل شعار
                                                    </div>
                                                    <input type="file" id="logoUpload" class="hidden" accept="image/*">
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Success Partners Section -->
                                    <div class="space-y-4">
                                        <h3 class="text-lg font-bold mb-2">شركاء النجاح</h3>
                                        <div class="border border-gray-300 rounded-lg p-4">
                                            <div id="partnersContainer" class="flex flex-wrap gap-4 mb-4">
                                                <!-- Partners will be displayed here -->
                                                <div class="text-center text-gray-500">لا يوجد شركاء حالياً</div>
                                            </div>
                                            
                                            <div class="border-t pt-4 mt-4">
                                                <h4 class="font-medium mb-2">إضافة شريك جديد</h4>
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">اسم الشريك</label>
                                                        <input type="text" id="partnerName" class="w-full p-2 border border-gray-300 rounded-md">
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">شعار الشريك</label>
                                                        <input type="file" id="partnerLogo" class="w-full p-2 border border-gray-300 rounded-md" accept="image/*">
                                                    </div>
                                                </div>
                                                <button id="addPartnerBtn" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300 mt-4">
                                                    <i class="fas fa-plus ml-1"></i> إضافة شريك
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                        <!-- Pending Registrations Section -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
                            <div class="px-6 py-4 border-b">
                                <h2 class="text-xl font-bold">طلبات التسجيل الجديدة</h2>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الاسم</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الواتساب</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الرخصة</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراء</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="pendingAgentsTable">
                                        <!-- Pending agents will be generated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="px-6 py-4 border-b flex justify-between items-center">
                                <h2 class="text-xl font-bold">إدارة العقارات</h2>
                                <button id="addPropertyBtn" class="bg-secondary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                                    <i class="fas fa-plus ml-1"></i> إضافة عقار
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الرقم</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">العنوان</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الموقع</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">السعر</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">النوع</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراء</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="adminPropertiesTable">
                                        <!-- Properties will be generated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- User Accounts Management -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden mt-8">
                            <div class="px-6 py-4 border-b">
                                <h2 class="text-xl font-bold">إدارة حسابات المستخدمين</h2>
                            </div>
                            <div class="px-6 py-4">
                                <!-- Tabs for different user types -->
                                <div class="border-b mb-6">
                                    <ul class="flex flex-wrap -mb-px">
                                        <li class="ml-4">
                                            <button id="tabBrokers" class="inline-block px-4 py-2 text-primary border-b-2 border-primary">الوسطاء</button>
                                        </li>
                                        <li class="ml-4">
                                            <button id="tabLawyers" class="inline-block px-4 py-2 text-gray-500 hover:text-gray-700">المحامين</button>
                                        </li>
                                        <li class="ml-4">
                                            <button id="tabFinance" class="inline-block px-4 py-2 text-gray-500 hover:text-gray-700">جهات التمويل</button>
                                        </li>
                                    </ul>
                                </div>
                                
                                <!-- Broker Accounts Tab -->
                                <div id="contentBrokers" class="account-tab-content">
                                    <div class="flex justify-end mb-4">
                                        <button id="brokerManageBtn" class="bg-secondary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                                            <i class="fas fa-cog ml-1"></i> إدارة الوسطاء
                                        </button>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الاسم</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الواتساب</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الرخصة</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">تاريخ الانضمام</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراء</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200" id="certifiedBrokersTable">
                                                <!-- Certified brokers will be generated here -->
                                                <tr>
                                                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">لا يوجد وسطاء معتمدين</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- Lawyers Accounts Tab -->
                                <div id="contentLawyers" class="account-tab-content hidden">
                                    <div class="flex justify-end mb-4">
                                        <button id="addLawyerBtn" class="bg-success text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                                            <i class="fas fa-plus ml-1"></i> إضافة محامي
                                        </button>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الاسم</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">البريد الإلكتروني</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الهاتف</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">تاريخ الإنشاء</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراء</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200" id="lawyersTable">
                                                <!-- Lawyers will be generated here -->
                                                <tr>
                                                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">لا يوجد محامين حالياً</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- Finance Accounts Tab -->
                                <div id="contentFinance" class="account-tab-content hidden">
                                    <div class="flex justify-end mb-4">
                                        <button id="addFinanceBtn" class="bg-accent text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                                            <i class="fas fa-plus ml-1"></i> إضافة جهة تمويل
                                        </button>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">اسم الجهة</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">البريد الإلكتروني</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الهاتف</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">تاريخ الإنشاء</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراء</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200" id="financeTable">
                                                <!-- Finance entities will be generated here -->
                                                <tr>
                                                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">لا توجد جهات تمويل حالياً</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Services Management -->
                        <div class="bg-white rounded-lg shadow-md overflow-hidden mt-8">
                            <div class="px-6 py-4 border-b">
                                <h2 class="text-xl font-bold">إدارة الخدمات الإضافية</h2>
                            </div>
                            <div class="p-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Quick Sale Requests -->
                                    <div class="border rounded-lg p-4">
                                        <h3 class="text-lg font-bold mb-4">طلبات البيع السريع</h3>
                                        <div id="quickSaleRequests" class="space-y-4">
                                            <!-- Quick sale requests will be generated here -->
                                            <div class="text-center text-gray-500">لا توجد طلبات حالية</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Financing Requests -->
                                    <div class="border rounded-lg p-4">
                                        <h3 class="text-lg font-bold mb-4">طلبات التمويل</h3>
                                        <div id="financingRequests" class="space-y-4">
                                            <!-- Financing requests will be generated here -->
                                            <div class="text-center text-gray-500">لا توجد طلبات حالية</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Dashboard (Hidden by default) -->
            <div id="agentDashboard" class="hidden">
                <div class="bg-gray-100 min-h-screen">
                    <nav class="bg-primary text-white shadow-md">
                        <div class="container mx-auto px-4">
                            <div class="flex items-center justify-between py-4">
                                <div class="flex items-center">
                                    <h1 class="text-xl font-bold">لوحة تحكم الوسيط العقاري</h1>
                                    <span id="agentName" class="mr-2 text-sm bg-secondary px-2 py-1 rounded-full"></span>
                                </div>
                                <button id="agentLogoutBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg text-sm transition duration-300">
                                    <i class="fas fa-sign-out-alt ml-1"></i> تسجيل خروج
                                </button>
                            </div>
                        </div>
                    </nav>

                    <div class="container mx-auto px-4 py-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center">
                                    <div class="bg-primary bg-opacity-20 p-3 rounded-full ml-4">
                                        <i class="fas fa-building text-primary text-xl"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm text-gray-500">عقاراتي المعلنة</div>
                                        <div class="text-2xl font-bold" id="agentTotalProperties">0</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <div class="flex items-center">
                                    <div class="bg-accent bg-opacity-20 p-3 rounded-full ml-4">
                                        <i class="fas fa-eye text-accent text-xl"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm text-gray-500">عدد المشاهدات</div>
                                        <div class="text-2xl font-bold" id="agentTotalViews">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="px-6 py-4 border-b flex justify-between items-center">
                                <h2 class="text-xl font-bold">إدارة عقاراتي</h2>
                                <button id="agentAddPropertyBtn" class="bg-secondary text-white px-4 py-2 rounded-lg hover:bg-opacity-80 transition duration-300">
                                    <i class="fas fa-plus ml-1"></i> إضافة عقار
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الرقم</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">العنوان</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الموقع</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">السعر</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">النوع</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراء</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="agentPropertiesTable">
                                        <!-- Agent properties will be generated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Sale Form (Hidden by default) -->
            <div id="quickSaleForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">طلب بيع سريع</h2>
                        <button id="closeQuickSaleBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="quickSaleFormContent">
                        <div class="mb-4">
                            <label for="qsName" class="block text-gray-700 mb-2">الاسم الكامل</label>
                            <input type="text" id="qsName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل اسمك الكامل" required>
                        </div>
                        <div class="mb-4">
                            <label for="qsPhone" class="block text-gray-700 mb-2">رقم الجوال</label>
                            <div class="flex">
                                <span class="bg-gray-100 border border-l-0 rounded-r-lg px-3 py-2">+966</span>
                                <input type="text" id="qsPhone" class="w-full px-4 py-2 border rounded-l-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="5xxxxxxxx" required pattern="[0-9]{9}">
                            </div>
                        </div>
                        <div class="mb-4">
                            <label for="qsPropertyType" class="block text-gray-700 mb-2">نوع العقار</label>
                            <select id="qsPropertyType" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" required>
                                <option value="">اختر نوع العقار</option>
                                <option value="building">عمائر</option>
                                <option value="villa">فلل</option>
                                <option value="apartment">شقق</option>
                                <option value="land">أراضي</option>
                                <option value="rest">استراحات</option>
                                <option value="floor">دور</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label for="qsLocation" class="block text-gray-700 mb-2">الموقع</label>
                            <input type="text" id="qsLocation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="المدينة، الحي" required>
                        </div>
                        <div class="mb-4">
                            <label for="qsPrice" class="block text-gray-700 mb-2">السعر المتوقع (تقريبي)</label>
                            <input type="number" id="qsPrice" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل السعر بالريال" required>
                        </div>
                        <div class="mb-6">
                            <label for="qsNotes" class="block text-gray-700 mb-2">ملاحظات إضافية</label>
                            <textarea id="qsNotes" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" rows="3" placeholder="أي معلومات إضافية تريد إضافتها"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-primary hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            إرسال الطلب
                        </button>
                    </form>
                </div>
            </div>

            <!-- Financing Form (Hidden by default) -->
            <div id="financingForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">طلب تمويل عقاري</h2>
                        <button id="closeFinancingBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="financingFormContent">
                        <div class="mb-4">
                            <label for="finName" class="block text-gray-700 mb-2">الاسم الكامل</label>
                            <input type="text" id="finName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل اسمك الكامل" required>
                        </div>
                        <div class="mb-4">
                            <label for="finPhone" class="block text-gray-700 mb-2">رقم الجوال</label>
                            <div class="flex">
                                <span class="bg-gray-100 border border-l-0 rounded-r-lg px-3 py-2">+966</span>
                                <input type="text" id="finPhone" class="w-full px-4 py-2 border rounded-l-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="5xxxxxxxx" required pattern="[0-9]{9}">
                            </div>
                        </div>
                        <div class="mb-4">
                            <label for="finAmount" class="block text-gray-700 mb-2">مبلغ التمويل المطلوب</label>
                            <input type="number" id="finAmount" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل المبلغ بالريال" required>
                        </div>
                        <div class="mb-4">
                            <label for="finSalary" class="block text-gray-700 mb-2">الراتب الشهري</label>
                            <input type="number" id="finSalary" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل الراتب الشهري بالريال" required>
                        </div>
                        <div class="mb-4">
                            <label for="finType" class="block text-gray-700 mb-2">نوع التمويل</label>
                            <select id="finType" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" required>
                                <option value="">اختر نوع التمويل</option>
                                <option value="residential">سكني</option>
                                <option value="commercial">تجاري</option>
                                <option value="land">أرض</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label for="finDetails" class="block text-gray-700 mb-2">تفاصيل إضافية</label>
                            <textarea id="finDetails" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" rows="3" placeholder="أي معلومات إضافية قد تساعد في معالجة طلبك"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-accent hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            تقديم طلب التمويل
                        </button>
                    </form>
                </div>
            </div>

            <!-- Add/Edit Property Modal (Hidden by default) -->
            <div id="propertyModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl p-6 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold" id="propertyModalTitle">إضافة عقار جديد</h2>
                        <button id="closePropertyModalBtn" class="text-gray-500 hover:text-gray-700 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="propertyFormContent">
                        <input type="hidden" id="propertyId">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="propTitle" class="block text-gray-700 mb-2">عنوان العقار</label>
                                <input type="text" id="propTitle" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل عنوان العقار" required>
                            </div>
                            <div>
                                <label for="propLocation" class="block text-gray-700 mb-2">الموقع</label>
                                <input type="text" id="propLocation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="المدينة، الحي" required>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label for="propPrice" class="block text-gray-700 mb-2">السعر</label>
                                <input type="number" id="propPrice" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="أدخل السعر بالريال" required>
                            </div>
                            <div>
                                <label for="propType" class="block text-gray-700 mb-2">نوع العقار</label>
                                <select id="propType" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" required>
                                    <option value="">اختر نوع العقار</option>
                                    <option value="building">عمائر</option>
                                    <option value="villa">فلل</option>
                                    <option value="apartment">شقق</option>
                                    <option value="land">أراضي</option>
                                    <option value="rest">استراحات</option>
                                    <option value="floor">دور</option>
                                </select>
                            </div>
                            <div>
                                <label for="propOperation" class="block text-gray-700 mb-2">نوع العملية</label>
                                <select id="propOperation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" required>
                                    <option value="">اختر نوع العملية</option>
                                    <option value="sale">بيع</option>
                                    <option value="rent">إيجار</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div>
                                <label for="propBedrooms" class="block text-gray-700 mb-2">عدد الغرف</label>
                                <input type="number" id="propBedrooms" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="0">
                            </div>
                            <div>
                                <label for="propBathrooms" class="block text-gray-700 mb-2">عدد الحمامات</label>
                                <input type="number" id="propBathrooms" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="0">
                            </div>
                            <div>
                                <label for="propArea" class="block text-gray-700 mb-2">المساحة (م²)</label>
                                <input type="number" id="propArea" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="0">
                            </div>
                            <div>
                                <label for="propYearBuilt" class="block text-gray-700 mb-2">سنة البناء</label>
                                <input type="number" id="propYearBuilt" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" placeholder="0">
                            </div>
                        </div>
                        <div class="mb-4">
                            <label for="propDescription" class="block text-gray-700 mb-2">الوصف</label>
                            <textarea id="propDescription" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" rows="4" placeholder="أدخل وصف العقار" required></textarea>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">المميزات</label>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                                <div class="flex items-center">
                                    <input type="checkbox" id="amenity1" class="ml-2">
                                    <label for="amenity1">تكييف مركزي</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="amenity2" class="ml-2">
                                    <label for="amenity2">مسبح خاص</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="amenity3" class="ml-2">
                                    <label for="amenity3">حديقة</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="amenity4" class="ml-2">
                                    <label for="amenity4">مطبخ مجهز</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="amenity5" class="ml-2">
                                    <label for="amenity5">نظام أمان</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="amenity6" class="ml-2">
                                    <label for="amenity6">قريبة من الخدمات</label>
                                </div>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">صور العقار</label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="propertyImages">
                                <!-- Property images for selection will be generated here -->
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-primary hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            حفظ
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-primary text-white py-8">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div>
                        <h3 class="text-xl font-bold mb-4">النخبة العقارية</h3>
                        <p class="mb-4">المنصة الرائدة في مجال التسويق العقاري في المملكة العربية السعودية</p>
                        <div class="flex space-x-4 space-x-reverse">
                            <a href="#" class="text-white hover:text-gray-300 transition duration-300">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="#" class="text-white hover:text-gray-300 transition duration-300">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="text-white hover:text-gray-300 transition duration-300">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-4">روابط سريعة</h3>
                        <ul class="space-y-2">
                            <li><a href="#" class="text-gray-300 hover:text-white transition duration-300">الرئيسية</a></li>
                            <li><a href="#" class="text-gray-300 hover:text-white transition duration-300">عقارات للبيع</a></li>
                            <li><a href="#" class="text-gray-300 hover:text-white transition duration-300">عقارات للإيجار</a></li>
                            <li><a href="#" class="text-gray-300 hover:text-white transition duration-300">تواصل معنا</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-4">تواصل معنا</h3>
                        <ul class="space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-map-marker-alt mt-1 ml-2"></i>
                                <span>الرياض، المملكة العربية السعودية</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-phone-alt mt-1 ml-2"></i>
                                <span>+966 53 534 2404</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-envelope mt-1 ml-2"></i>
                                <span>info@aqarak.com</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-8 pt-8 text-center">
                    <p>&copy; 2023 النخبة العقارية. جميع الحقوق محفوظة.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
    (function() {
        // ----- Data Storage -----
        // Store data in localStorage
        function initializeLocalStorage() {
            if (!localStorage.getItem('aqarak_visitors')) {
                localStorage.setItem('aqarak_visitors', '1245');
            }
            
            if (!localStorage.getItem('aqarak_properties')) {
                // Initialize with 50 property templates
                const properties = [];
                const propertyTypes = ['building', 'villa', 'apartment', 'land', 'rest', 'floor'];
                const cities = ['الرياض', 'جدة', 'الدمام', 'مكة المكرمة', 'المدينة المنورة', 'الطائف', 'الخبر', 'تبوك', 'أبها'];
                const districts = ['حي النرجس', 'حي الياسمين', 'حي الملقا', 'حي العليا', 'حي الورود', 'طريق الملك', 'حي الشاطئ', 'حي الأزهر', 'العزيزية', 'حي السلامة'];
                const operations = ['sale', 'rent'];
                const propertyImages = [
                    'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1628744448839-a475fc846be4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1628624747186-a941c476b7ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1595526114035-0d45ed16cfbf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1560440021-33f9b867899d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                    'https://images.unsplash.com/photo-1583608205776-bfd35f0d9f83?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80'
                ];
                
                for (let i = 1; i <= 50; i++) {
                    const propType = propertyTypes[Math.floor(Math.random() * propertyTypes.length)];
                    const city = cities[Math.floor(Math.random() * cities.length)];
                    const district = districts[Math.floor(Math.random() * districts.length)];
                    const operation = operations[Math.floor(Math.random() * operations.length)];
                    const price = Math.floor(Math.random() * 9000000) + 100000;
                    const bedrooms = propType === 'land' ? 0 : Math.floor(Math.random() * 6) + 1;
                    const bathrooms = propType === 'land' ? 0 : Math.floor(Math.random() * 4) + 1;
                    const area = Math.floor(Math.random() * 900) + 100;
                    
                    let title = '';
                    let description = '';
                    
                    switch (propType) {
                        case 'building':
                            title = `برج ${operation === 'sale' ? 'للبيع' : 'للإيجار'} في ${city}`;
                            description = `برج فاخر في ${city}، ${district}. مكون من عدة طوابق ويحتوي على العديد من المكاتب والوحدات السكنية. موقع استراتيجي ممتاز وقريب من الخدمات والمرافق العامة.`;
                            break;
                        case 'villa':
                            title = `فيلا ${operation === 'sale' ? 'للبيع' : 'للإيجار'} في ${city}`;
                            description = `فيلا فاخرة في ${city}، ${district}. تتكون من ${bedrooms} غرف نوم و${bathrooms} حمامات، مع مساحة ${area} متر مربع. تصميم عصري وموقع متميز قريب من الخدمات.`;
                            break;
                        case 'apartment':
                            title = `شقة ${operation === 'sale' ? 'للبيع' : 'للإيجار'} في ${city}`;
                            description = `شقة فاخرة في ${city}، ${district}. تتكون من ${bedrooms} غرف نوم و${bathrooms} حمامات، مع مساحة ${area} متر مربع. تشطيب ممتاز وموقع حيوي.`;
                            break;
                        case 'land':
                            title = `أرض ${operation === 'sale' ? 'للبيع' : 'للإيجار'} في ${city}`;
                            description = `أرض بمساحة ${area} متر مربع في ${city}، ${district}. موقع متميز وصك إلكتروني جاهز. مناسبة للاستثمار أو البناء السكني.`;
                            break;
                        case 'rest':
                            title = `استراحة ${operation === 'sale' ? 'للبيع' : 'للإيجار'} في ${city}`;
                            description = `استراحة فاخرة في ${city}، ${district}. تحتوي على ${bedrooms} غرف نوم و${bathrooms} حمامات، مع مساحة ${area} متر مربع. تضم مسبح ومجلس وحديقة خاصة.`;
                            break;
                        case 'floor':
                            title = `دور ${operation === 'sale' ? 'للبيع' : 'للإيجار'} في ${city}`;
                            description = `دور كامل في ${city}، ${district}. يتكون من ${bedrooms} غرف نوم و${bathrooms} حمامات، مع مساحة ${area} متر مربع. مدخل خاص وتشطيب راقي.`;
                            break;
                    }
                    
                    // Generate 3 random images from the array
                    const images = [];
                    const usedIndices = new Set();
                    while (images.length < 3) {
                        const randomIndex = Math.floor(Math.random() * propertyImages.length);
                        if (!usedIndices.has(randomIndex)) {
                            usedIndices.add(randomIndex);
                            images.push(propertyImages[randomIndex]);
                        }
                    }
                    
                    properties.push({
                        id: i,
                        title: title,
                        location: `${city}، ${district}`,
                        price: price,
                        type: propType,
                        operation: operation,
                        description: description,
                        images: images,
                        bedrooms: bedrooms,
                        bathrooms: bathrooms,
                        area: area,
                        yearBuilt: 2020 + Math.floor(Math.random() * 4),
                        amenities: {
                            centralAC: Math.random() > 0.5,
                            pool: Math.random() > 0.7,
                            garden: Math.random() > 0.6,
                            kitchen: Math.random() > 0.4,
                            security: Math.random() > 0.5,
                            nearServices: Math.random() > 0.3
                        },
                        agentId: Math.random() > 0.7 ? 1 : null,
                        views: Math.floor(Math.random() * 100)
                    });
                }
                localStorage.setItem('aqarak_properties', JSON.stringify(properties));
            }
            
            // Initialize quick sale requests if not exists
            if (!localStorage.getItem('quickSaleRequests')) {
                localStorage.setItem('quickSaleRequests', JSON.stringify([]));
            }
            
            // Initialize financing requests if not exists
            if (!localStorage.getItem('financingRequests')) {
                localStorage.setItem('financingRequests', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('aqarak_agents')) {
                const agents = [
                    {
                        id: 1,
                        name: 'محمد عبدالله العتيبي',
                        whatsapp: '505556677',
                        licenseNumber: 'RT-54321',
                        status: 'approved',
                        password: 'agent123'
                    }
                ];
                localStorage.setItem('aqarak_agents', JSON.stringify(agents));
            }
            
            if (!localStorage.getItem('aqarak_pending_agents')) {
                const pendingAgents = [
                    {
                        id: 2,
                        name: 'سارة محمد الشمري',
                        whatsapp: '512223344',
                        licenseNumber: 'RT-98765',
                        status: 'pending'
                    }
                ];
                localStorage.setItem('aqarak_pending_agents', JSON.stringify(pendingAgents));
            }
        }
        
        function getVisitorCount() {
            return parseInt(localStorage.getItem('aqarak_visitors'));
        }
        
        function updateVisitorCount(count) {
            localStorage.setItem('aqarak_visitors', count.toString());
        }
        
        function getProperties() {
            return JSON.parse(localStorage.getItem('aqarak_properties'));
        }
        
        function updateProperties(properties) {
            localStorage.setItem('aqarak_properties', JSON.stringify(properties));
        }
        
        function getAgents() {
            return JSON.parse(localStorage.getItem('aqarak_agents'));
        }
        
        function updateAgents(agents) {
            localStorage.setItem('aqarak_agents', JSON.stringify(agents));
        }
        
        function getPendingAgents() {
            return JSON.parse(localStorage.getItem('aqarak_pending_agents'));
        }
        
        function updatePendingAgents(pendingAgents) {
            localStorage.setItem('aqarak_pending_agents', JSON.stringify(pendingAgents));
        }
        
        // دالة للحصول على المستخدم الحالي
        function getCurrentUser() {
            const userStr = localStorage.getItem('aqarak_current_user');
            return userStr ? JSON.parse(userStr) : null;
        }
        
        // دالة لتعيين المستخدم الحالي
        function setCurrentUser(user) {
            if (user) {
                localStorage.setItem('aqarak_current_user', JSON.stringify(user));
            } else {
                localStorage.removeItem('aqarak_current_user');
            }
        }
        
        // دالة لإضافة عقار جديد
        function addNewProperty(property) {
            const properties = JSON.parse(localStorage.getItem('aqarak_properties') || '[]');
            properties.push(property);
            localStorage.setItem('aqarak_properties', JSON.stringify(properties));
            return property;
        }
        
        function getPropertyById(id) {
            const properties = getProperties();
            return properties.find(p => p.id === parseInt(id));
        }
        
        function getAgentById(id) {
            const agents = getAgents();
            return agents.find(a => a.id === parseInt(id));
        }
        
        function addProperty(property) {
            const properties = getProperties();
            const maxId = properties.reduce((max, p) => Math.max(max, p.id), 0);
            property.id = maxId + 1;
            property.views = 0;
            properties.push(property);
            updateProperties(properties);
            return property;
        }
        
        function updateProperty(property) {
            const properties = getProperties();
            const index = properties.findIndex(p => p.id === parseInt(property.id));
            if (index !== -1) {
                properties[index] = { ...properties[index], ...property };
                updateProperties(properties);
                return properties[index];
            }
            return null;
        }
        
        function deleteProperty(id) {
            const properties = getProperties();
            const filteredProperties = properties.filter(p => p.id !== parseInt(id));
            updateProperties(filteredProperties);
        }
        
        function addAgent(agent) {
            const pendingAgents = getPendingAgents();
            const maxId = pendingAgents.reduce((max, a) => Math.max(max, a.id), 0);
            agent.id = maxId + 1;
            agent.status = 'pending';
            pendingAgents.push(agent);
            updatePendingAgents(pendingAgents);
            return agent;
        }
        
        function approveAgent(id) {
            const pendingAgents = getPendingAgents();
            const agentIndex = pendingAgents.findIndex(a => a.id === parseInt(id));
            
            if (agentIndex !== -1) {
                const agent = { ...pendingAgents[agentIndex], status: 'approved', password: 'agent123' };
                const agents = getAgents();
                agents.push(agent);
                updateAgents(agents);
                
                // Remove from pending
                const filteredPendingAgents = pendingAgents.filter(a => a.id !== parseInt(id));
                updatePendingAgents(filteredPendingAgents);
                
                return agent;
            }
            return null;
        }
        
        function rejectAgent(id) {
            const pendingAgents = getPendingAgents();
            const filteredPendingAgents = pendingAgents.filter(a => a.id !== parseInt(id));
            updatePendingAgents(filteredPendingAgents);
        }
        
        function filterProperties(filters) {
            let properties = getProperties();
            
            if (filters.term) {
                const searchTerm = filters.term.toLowerCase();
                properties = properties.filter(p => 
                    p.title.toLowerCase().includes(searchTerm) || 
                    p.location.toLowerCase().includes(searchTerm) || 
                    p.description.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filters.type) {
                properties = properties.filter(p => p.type === filters.type);
            }
            
            if (filters.operation) {
                properties = properties.filter(p => p.operation === filters.operation);
            }
            
            if (filters.priceRange) {
                const [min, max] = filters.priceRange.split('-');
                if (min && max) {
                    properties = properties.filter(p => p.price >= parseInt(min) && p.price <= parseInt(max));
                } else if (min) {
                    properties = properties.filter(p => p.price >= parseInt(min));
                }
            }
            
            if (filters.agentId) {
                properties = properties.filter(p => p.agentId === filters.agentId);
            }
            
            return properties;
        }
        
        // ----- DOM Elements -----
        const homePageEl = document.getElementById('homePage');
        const propertyDetailsPageEl = document.getElementById('propertyDetailsPage');
        const loginFormEl = document.getElementById('loginForm');
        const registerFormEl = document.getElementById('registerForm');
        const registrationSuccessEl = document.getElementById('registrationSuccess');
        const adminDashboardEl = document.getElementById('adminDashboard');
        const agentDashboardEl = document.getElementById('agentDashboard');
        const propertyModalEl = document.getElementById('propertyModal');
        
        // ----- Visitor Counter -----
        const visitorCountEl = document.getElementById('visitorCount');
        const adminVisitorCountEl = document.getElementById('adminVisitorCount');
        let visitorCount = getVisitorCount();
        
        function updateVisitorCountDisplay() {
            visitorCountEl.textContent = visitorCount.toLocaleString();
            if (adminVisitorCountEl) {
                adminVisitorCountEl.textContent = visitorCount.toLocaleString();
            }
        }
        
        // Increment visitor count randomly
        setInterval(() => {
            visitorCount += Math.floor(Math.random() * 2);
            updateVisitorCount(visitorCount);
            updateVisitorCountDisplay();
        }, 30000);
        
        // ----- Property Display -----
        function renderPropertyCards(filters = {}) {
            const propertiesContainer = document.getElementById('propertiesContainer');
            propertiesContainer.innerHTML = '';
            
            const properties = filterProperties(filters);
            
            properties.slice(0, 6).forEach(property => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition duration-300';
                card.setAttribute('data-property-id', property.id);
                
                const amenities = [];
                if (property.bedrooms > 0) {
                    amenities.push(`
                        <div class="flex items-center ml-3">
                            <i class="fas fa-bed ml-1"></i>
                            <span>${property.bedrooms}</span>
                        </div>
                    `);
                }
                if (property.bathrooms > 0) {
                    amenities.push(`
                        <div class="flex items-center">
                            <i class="fas fa-bath ml-1"></i>
                            <span>${property.bathrooms}</span>
                        </div>
                    `);
                }
                if (property.type === 'land' || property.type === 'building') {
                    amenities.push(`
                        <div class="flex items-center">
                            <i class="fas fa-ruler-combined ml-1"></i>
                            <span>${property.area} م²</span>
                        </div>
                    `);
                }
                
                const formattedPrice = property.operation === 'rent' 
                    ? `${property.price.toLocaleString()} ريال/سنة` 
                    : `${property.price.toLocaleString()} ريال`;
                
                card.innerHTML = `
                    <div class="relative">
                        <span class="absolute top-2 right-2 bg-accent text-white px-2 py-1 rounded-lg z-10">#${property.id}</span>
                        <img src="${property.images[0]}" alt="${property.title}" class="w-full h-56 object-cover">
                    </div>
                    <div class="p-4">
                        <h3 class="text-xl font-bold mb-2">${property.title}</h3>
                        <div class="flex items-center text-gray-600 mb-2">
                            <i class="fas fa-map-marker-alt ml-2"></i>
                            <span>${property.location}</span>
                        </div>
                        <div class="flex justify-between items-center mb-3">
                            <div class="text-xl font-bold text-secondary">${formattedPrice}</div>
                            <div class="flex">
                                ${amenities.join('')}
                            </div>
                        </div>
                        <div class="flex">
                            <button class="show-details flex-1 bg-primary hover:bg-opacity-80 text-white py-2 rounded-lg ml-2 transition duration-300">عرض التفاصيل</button>
                            <a href="https://wa.me/966535342404?text=استفسار حول ${encodeURIComponent(property.title)} بسعر ${encodeURIComponent(formattedPrice)}" class="flex items-center justify-center bg-green-500 hover:bg-green-600 text-white w-12 rounded-lg transition duration-300">
                                <i class="fab fa-whatsapp text-xl"></i>
                            </a>
                        </div>
                    </div>
                `;
                
                propertiesContainer.appendChild(card);
            });
            
            // Attach event listeners after rendering cards
            attachPropertyCardListeners();
        }
        
        function attachPropertyCardListeners() {
            const showDetailsButtons = document.querySelectorAll('.show-details');
            showDetailsButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const propertyCard = this.closest('[data-property-id]');
                    const propertyId = propertyCard.getAttribute('data-property-id');
                    showPropertyDetails(propertyId);
                });
            });
        }
        
        function showPropertyDetails(propertyId) {
            const property = getPropertyById(propertyId);
            
            if (!property) return;
            
            // Update property views
            const properties = getProperties();
            const propertyIndex = properties.findIndex(p => p.id === parseInt(propertyId));
            if (propertyIndex !== -1) {
                properties[propertyIndex].views = (properties[propertyIndex].views || 0) + 1;
                updateProperties(properties);
            }
            
            // Update carousel
            const carousel = document.getElementById('propertyCarousel');
            carousel.innerHTML = '';
            
            property.images.forEach((image, index) => {
                const item = document.createElement('div');
                item.className = 'carousel-item';
                item.innerHTML = `<img src="${image}" alt="${property.title}" class="w-full h-96 object-cover">`;
                carousel.appendChild(item);
            });
            
            // Update thumbnails
            const thumbnailContainer = document.getElementById('thumbnailContainer');
            thumbnailContainer.innerHTML = '';
            
            property.images.forEach((image, index) => {
                const thumbnail = document.createElement('img');
                thumbnail.src = image;
                thumbnail.alt = `صورة مصغرة ${index + 1}`;
                thumbnail.className = 'w-24 h-16 object-cover rounded cursor-pointer';
                thumbnail.addEventListener('click', () => {
                    currentIndex = index;
                    updateCarousel();
                });
                thumbnailContainer.appendChild(thumbnail);
            });
            
            // Update property details
            document.getElementById('propertyTitle').textContent = property.title;
            document.getElementById('propertyPrice').textContent = property.operation === 'rent' 
                ? `${property.price.toLocaleString()} ريال/سنة` 
                : `${property.price.toLocaleString()} ريال`;
            document.getElementById('propertyLocation').textContent = property.location;
            document.getElementById('propertyDescription').textContent = property.description;
            
            // Update features
            const featuresContainer = document.getElementById('propertyFeatures');
            featuresContainer.innerHTML = '';
            
            if (property.bedrooms > 0) {
                featuresContainer.innerHTML += `
                    <div class="bg-gray-100 p-4 rounded-lg text-center">
                        <i class="fas fa-bed text-primary text-xl mb-2"></i>
                        <div class="text-sm text-gray-600">غرف النوم</div>
                        <div class="font-bold">${property.bedrooms}</div>
                    </div>
                `;
            }
            
            if (property.bathrooms > 0) {
                featuresContainer.innerHTML += `
                    <div class="bg-gray-100 p-4 rounded-lg text-center">
                        <i class="fas fa-bath text-primary text-xl mb-2"></i>
                        <div class="text-sm text-gray-600">دورات المياه</div>
                        <div class="font-bold">${property.bathrooms}</div>
                    </div>
                `;
            }
            
            featuresContainer.innerHTML += `
                <div class="bg-gray-100 p-4 rounded-lg text-center">
                    <i class="fas fa-ruler-combined text-primary text-xl mb-2"></i>
                    <div class="text-sm text-gray-600">المساحة</div>
                    <div class="font-bold">${property.area} م²</div>
                </div>
            `;
            
            if (property.type !== 'land') {
                featuresContainer.innerHTML += `
                    <div class="bg-gray-100 p-4 rounded-lg text-center">
                        <i class="fas fa-calendar-alt text-primary text-xl mb-2"></i>
                        <div class="text-sm text-gray-600">سنة البناء</div>
                        <div class="font-bold">${property.yearBuilt}</div>
                    </div>
                `;
            }
            
            // Update amenities
            const amenitiesContainer = document.getElementById('propertyAmenities');
            amenitiesContainer.innerHTML = '';
            
            if (property.amenities) {
                if (property.amenities.centralAC) {
                    amenitiesContainer.innerHTML += `
                        <div class="flex items-center">
                            <i class="fas fa-check text-success ml-2"></i>
                            <span>تكييف مركزي</span>
                        </div>
                    `;
                }
                
                if (property.amenities.pool) {
                    amenitiesContainer.innerHTML += `
                        <div class="flex items-center">
                            <i class="fas fa-check text-success ml-2"></i>
                            <span>مسبح خاص</span>
                        </div>
                    `;
                }
                
                if (property.amenities.garden) {
                    amenitiesContainer.innerHTML += `
                        <div class="flex items-center">
                            <i class="fas fa-check text-success ml-2"></i>
                            <span>حديقة</span>
                        </div>
                    `;
                }
                
                if (property.amenities.kitchen) {
                    amenitiesContainer.innerHTML += `
                        <div class="flex items-center">
                            <i class="fas fa-check text-success ml-2"></i>
                            <span>مطبخ مجهز</span>
                        </div>
                    `;
                }
                
                if (property.amenities.security) {
                    amenitiesContainer.innerHTML += `
                        <div class="flex items-center">
                            <i class="fas fa-check text-success ml-2"></i>
                            <span>نظام أمان</span>
                        </div>
                    `;
                }
                
                if (property.amenities.nearServices) {
                    amenitiesContainer.innerHTML += `
                        <div class="flex items-center">
                            <i class="fas fa-check text-success ml-2"></i>
                            <span>قريبة من الخدمات</span>
                        </div>
                    `;
                }
            }
            
            // Update WhatsApp link
            const formattedPrice = property.operation === 'rent' 
                ? `${property.price.toLocaleString()} ريال/سنة` 
                : `${property.price.toLocaleString()} ريال`;
            
            const whatsappLink = document.getElementById('whatsappLink');
            whatsappLink.href = `https://wa.me/966535342404?text=استفسار حول ${encodeURIComponent(property.title)} بسعر ${encodeURIComponent(formattedPrice)}`;
            
            // Show property details page
            homePageEl.classList.add('hidden');
            propertyDetailsPageEl.classList.remove('hidden');
            
            // Update browser history
            window.history.pushState({page: 'propertyDetails', id: propertyId}, '', `#property-${propertyId}`);
            
            // Reset carousel
            currentIndex = 0;
            updateCarousel();
        }
        
        // ----- Search Functionality -----
        const searchBtn = document.getElementById('searchBtn');
        searchBtn.addEventListener('click', function() {
            const searchTerm = document.getElementById('searchTerm').value;
            const propertyType = document.getElementById('propertyType').value;
            const priceRange = document.getElementById('priceRange').value;
            
            renderPropertyCards({
                term: searchTerm,
                type: propertyType,
                priceRange: priceRange
            });
        });
        
        // Category filtering
        document.querySelectorAll('[data-category]').forEach(category => {
            category.addEventListener('click', function() {
                const categoryType = this.getAttribute('data-category');
                renderPropertyCards({ type: categoryType });
            });
        });
        
        // Operation filtering
        document.querySelectorAll('[data-operation]').forEach(operation => {
            operation.addEventListener('click', function() {
                const operationType = this.getAttribute('data-operation');
                renderPropertyCards({ operation: operationType });
            });
        });
        
        // ----- Property Carousel -----
        const carousel = document.querySelector('.carousel');
        const carouselInner = carousel.querySelector('.carousel-inner');
        const prevButton = carousel.querySelector('.carousel-control-prev');
        const nextButton = carousel.querySelector('.carousel-control-next');
        let currentIndex = 0;
        
        function updateCarousel() {
            const carouselInner = document.querySelector('.carousel-inner');
            if (carouselInner) {
                carouselInner.style.transform = `translateX(${currentIndex * 100}%)`;
            }
        }
        
        prevButton.addEventListener('click', function() {
            const items = carousel.querySelectorAll('.carousel-item');
            currentIndex = (currentIndex + 1) % items.length;
            updateCarousel();
        });
        
        nextButton.addEventListener('click', function() {
            const items = carousel.querySelectorAll('.carousel-item');
            currentIndex = (currentIndex - 1 + items.length) % items.length;
            updateCarousel();
        });
        
        // ----- Navigation -----
        const backToHomeBtn = document.getElementById('backToHomeBtn');
        backToHomeBtn.addEventListener('click', function() {
            propertyDetailsPageEl.classList.add('hidden');
            homePageEl.classList.remove('hidden');
            window.history.pushState({page: 'home'}, '', '#');
        });
        
        // ----- Login Form -----
        const loginBtn = document.getElementById('loginBtn');
        const closeLoginBtn = document.getElementById('closeLoginBtn');
        
        loginBtn.addEventListener('click', function() {
            loginFormEl.classList.remove('hidden');
        });
        
        closeLoginBtn.addEventListener('click', function() {
            loginFormEl.classList.add('hidden');
        });
        
        const loginFormContent = document.getElementById('loginFormContent');
        const loginError = document.getElementById('loginError');
        
        loginFormContent.addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'IVL511' && password === 'WA@055364') {
                // Admin login successful
                loginFormEl.classList.add('hidden');
                homePageEl.classList.add('hidden');
                adminDashboardEl.classList.remove('hidden');
                updateAdminDashboard();
                window.history.pushState({page: 'adminDashboard'}, '', '#admin');
            } else {
                // Check if agent login
                const agents = getAgents();
                const agent = agents.find(a => a.name === username && a.password === password);
                
                if (agent) {
                    // Agent login successful
                    document.getElementById('agentName').textContent = agent.name;
                    loginFormEl.classList.add('hidden');
                    homePageEl.classList.add('hidden');
                    agentDashboardEl.classList.remove('hidden');
                    updateAgentDashboard(agent.id);
                    window.history.pushState({page: 'agentDashboard', id: agent.id}, '', '#agent');
                } else {
                    // Login failed
                    loginError.classList.remove('hidden');
                }
            }
        });
        
        // ----- Register Form -----
        const registerBtn = document.getElementById('registerBtn');
        const closeRegisterBtn = document.getElementById('closeRegisterBtn');
        
        registerBtn.addEventListener('click', function() {
            registerFormEl.classList.remove('hidden');
        });
        
        closeRegisterBtn.addEventListener('click', function() {
            registerFormEl.classList.add('hidden');
        });
        
        const registerFormContent = document.getElementById('registerFormContent');
        const closeSuccessBtn = document.getElementById('closeSuccessBtn');
        
        registerFormContent.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const fullName = document.getElementById('fullName').value;
            const whatsapp = document.getElementById('whatsapp').value;
            const licenseNumber = document.getElementById('licenseNumber').value;
            
            // Add new pending agent
            addAgent({
                name: fullName,
                whatsapp: whatsapp,
                licenseNumber: licenseNumber
            });
            
            registerFormEl.classList.add('hidden');
            registrationSuccessEl.classList.remove('hidden');
        });
        
        closeSuccessBtn.addEventListener('click', function() {
            registrationSuccessEl.classList.add('hidden');
        });
        
        // ----- Admin Dashboard -----
        // Helper functions for quick sale and financing requests
        function getQuickSaleRequests() {
            return JSON.parse(localStorage.getItem('quickSaleRequests') || '[]');
        }
        
        function getFinancingRequests() {
            return JSON.parse(localStorage.getItem('financingRequests') || '[]');
        }
        
        function updateQuickSaleRequests(requests) {
            localStorage.setItem('quickSaleRequests', JSON.stringify(requests));
        }
        
        function updateFinancingRequests(requests) {
            localStorage.setItem('financingRequests', JSON.stringify(requests));
        }
        
        function updateAdminDashboard() {
            const properties = getProperties();
            const agents = getAgents();
            const pendingAgents = getPendingAgents();
            const quickSaleRequests = getQuickSaleRequests();
            const financingRequests = getFinancingRequests();
            
            // Update stats
            document.getElementById('totalProperties').textContent = properties.length.toString();
            document.getElementById('totalAgents').textContent = agents.length.toString();
            document.getElementById('adminVisitorCount').textContent = visitorCount.toString();
            
            // Update quick sale requests section
            const quickSaleRequestsEl = document.getElementById('quickSaleRequests');
            quickSaleRequestsEl.innerHTML = '';
            
            if (quickSaleRequests.length === 0) {
                quickSaleRequestsEl.innerHTML = `<div class="text-center text-gray-500">لا توجد طلبات حالية</div>`;
            } else {
                quickSaleRequests.forEach(request => {
                    const requestEl = document.createElement('div');
                    requestEl.className = 'bg-white shadow rounded-lg p-4';
                    
                    const formattedDate = new Date(request.date).toLocaleDateString('ar-SA');
                    const statusClass = request.status === 'pending' ? 'bg-yellow-100 text-yellow-800' : 
                                        request.status === 'completed' ? 'bg-green-100 text-green-800' : 
                                        'bg-red-100 text-red-800';
                    
                    const statusText = request.status === 'pending' ? 'قيد المراجعة' : 
                                       request.status === 'completed' ? 'تم التنفيذ' : 'تم الرفض';
                    
                    requestEl.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-bold">${request.name}</h4>
                            <span class="${statusClass} text-xs px-2 py-1 rounded-full">${statusText}</span>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">
                            <div><span class="font-medium ml-1">الهاتف:</span> ${request.phone}</div>
                            <div><span class="font-medium ml-1">النوع:</span> ${request.propertyType}</div>
                            <div><span class="font-medium ml-1">الموقع:</span> ${request.location}</div>
                            <div><span class="font-medium ml-1">السعر:</span> ${request.price.toLocaleString()} ريال</div>
                            <div><span class="font-medium ml-1">التاريخ:</span> ${formattedDate}</div>
                            ${request.notes ? `<div><span class="font-medium ml-1">ملاحظات:</span> ${request.notes}</div>` : ''}
                        </div>
                        <div class="flex mt-2">
                            ${request.status === 'pending' ? `
                                <button class="complete-quick-sale bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-lg ml-2 text-sm" data-id="${request.id}">تم التنفيذ</button>
                                <button class="reject-quick-sale bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-lg text-sm" data-id="${request.id}">رفض</button>
                            ` : ''}
                        </div>
                    `;
                    
                    quickSaleRequestsEl.appendChild(requestEl);
                });
                
                // Attach event listeners
                document.querySelectorAll('.complete-quick-sale').forEach(button => {
                    button.addEventListener('click', function() {
                        const requestId = parseInt(this.getAttribute('data-id'));
                        updateQuickSaleRequestStatus(requestId, 'completed');
                    });
                });
                
                document.querySelectorAll('.reject-quick-sale').forEach(button => {
                    button.addEventListener('click', function() {
                        const requestId = parseInt(this.getAttribute('data-id'));
                        updateQuickSaleRequestStatus(requestId, 'rejected');
                    });
                });
            }
            
            // Update financing requests section
            const financingRequestsEl = document.getElementById('financingRequests');
            financingRequestsEl.innerHTML = '';
            
            if (financingRequests.length === 0) {
                financingRequestsEl.innerHTML = `<div class="text-center text-gray-500">لا توجد طلبات حالية</div>`;
            } else {
                financingRequests.forEach(request => {
                    const requestEl = document.createElement('div');
                    requestEl.className = 'bg-white shadow rounded-lg p-4';
                    
                    const formattedDate = new Date(request.date).toLocaleDateString('ar-SA');
                    const statusClass = request.status === 'pending' ? 'bg-yellow-100 text-yellow-800' : 
                                        request.status === 'completed' ? 'bg-green-100 text-green-800' : 
                                        'bg-red-100 text-red-800';
                    
                    const statusText = request.status === 'pending' ? 'قيد المراجعة' : 
                                       request.status === 'completed' ? 'تم التنفيذ' : 'تم الرفض';
                    
                    requestEl.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-bold">${request.name}</h4>
                            <span class="${statusClass} text-xs px-2 py-1 rounded-full">${statusText}</span>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">
                            <div><span class="font-medium ml-1">الهاتف:</span> ${request.phone}</div>
                            <div><span class="font-medium ml-1">مبلغ التمويل:</span> ${request.amount.toLocaleString()} ريال</div>
                            <div><span class="font-medium ml-1">الراتب:</span> ${request.salary.toLocaleString()} ريال</div>
                            <div><span class="font-medium ml-1">نوع التمويل:</span> ${request.type}</div>
                            <div><span class="font-medium ml-1">التاريخ:</span> ${formattedDate}</div>
                            ${request.details ? `<div><span class="font-medium ml-1">تفاصيل:</span> ${request.details}</div>` : ''}
                        </div>
                        <div class="flex mt-2">
                            ${request.status === 'pending' ? `
                                <button class="complete-financing bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-lg ml-2 text-sm" data-id="${request.id}">تم التنفيذ</button>
                                <button class="reject-financing bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-lg text-sm" data-id="${request.id}">رفض</button>
                            ` : ''}
                        </div>
                    `;
                    
                    financingRequestsEl.appendChild(requestEl);
                });
                
                // Attach event listeners
                document.querySelectorAll('.complete-financing').forEach(button => {
                    button.addEventListener('click', function() {
                        const requestId = parseInt(this.getAttribute('data-id'));
                        updateFinancingRequestStatus(requestId, 'completed');
                    });
                });
                
                document.querySelectorAll('.reject-financing').forEach(button => {
                    button.addEventListener('click', function() {
                        const requestId = parseInt(this.getAttribute('data-id'));
                        updateFinancingRequestStatus(requestId, 'rejected');
                    });
                });
            }
            
            // Update pending agents table
            const pendingAgentsTable = document.getElementById('pendingAgentsTable');
            pendingAgentsTable.innerHTML = '';
            
            if (pendingAgents.length === 0) {
                pendingAgentsTable.innerHTML = `
                    <tr>
                        <td colspan="4" class="px-6 py-4 text-center text-gray-500">لا توجد طلبات تسجيل جديدة</td>
                    </tr>
                `;
            } else {
                pendingAgents.forEach(agent => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${agent.name}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">+966${agent.whatsapp}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${agent.licenseNumber}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2 space-x-reverse">
                                <button class="approve-agent bg-success text-white px-3 py-1 rounded-lg hover:bg-opacity-80 transition duration-300" data-agent-id="${agent.id}">قبول</button>
                                <button class="reject-agent bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-opacity-80 transition duration-300" data-agent-id="${agent.id}">رفض</button>
                            </div>
                        </td>
                    `;
                    pendingAgentsTable.appendChild(row);
                });
                
                // Attach event listeners
                document.querySelectorAll('.approve-agent').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const agentId = this.getAttribute('data-agent-id');
                        approveAgent(agentId);
                        updateAdminDashboard();
                    });
                });
                
                document.querySelectorAll('.reject-agent').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const agentId = this.getAttribute('data-agent-id');
                        rejectAgent(agentId);
                        updateAdminDashboard();
                    });
                });
            }
            
            // Update properties table
            const adminPropertiesTable = document.getElementById('adminPropertiesTable');
            adminPropertiesTable.innerHTML = '';
            
            if (properties.length === 0) {
                adminPropertiesTable.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-4 text-center text-gray-500">لا توجد عقارات</td>
                    </tr>
                `;
            } else {
                properties.forEach(property => {
                    const formattedPrice = property.operation === 'rent' 
                        ? `${property.price.toLocaleString()} ريال/سنة` 
                        : `${property.price.toLocaleString()} ريال`;
                    
                    let propertyTypeText = '';
                    switch (property.type) {
                        case 'building': propertyTypeText = 'عمائر'; break;
                        case 'villa': propertyTypeText = 'فلل'; break;
                        case 'apartment': propertyTypeText = 'شقق'; break;
                        case 'land': propertyTypeText = 'أراضي'; break;
                        case 'rest': propertyTypeText = 'استراحات'; break;
                        case 'floor': propertyTypeText = 'دور'; break;
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">#${property.id}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${property.title}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${property.location}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-secondary">${formattedPrice}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${propertyTypeText}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2 space-x-reverse">
                                <button class="edit-property text-secondary hover:text-opacity-80 transition duration-300" data-property-id="${property.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="delete-property text-red-500 hover:text-opacity-80 transition duration-300" data-property-id="${property.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    adminPropertiesTable.appendChild(row);
                });
                
                // Attach event listeners
                document.querySelectorAll('.edit-property').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const propertyId = this.getAttribute('data-property-id');
                        openPropertyModal(propertyId);
                    });
                });
                
                document.querySelectorAll('.delete-property').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const propertyId = this.getAttribute('data-property-id');
                        if (confirm('هل أنت متأكد من حذف هذا العقار؟')) {
                            deleteProperty(propertyId);
                            updateAdminDashboard();
                        }
                    });
                });
            }
        }
        
        // Update quick sale and financing request status functions
        function updateQuickSaleRequestStatus(id, status) {
            const requests = getQuickSaleRequests();
            const index = requests.findIndex(req => req.id === id);
            
            if (index !== -1) {
                requests[index].status = status;
                updateQuickSaleRequests(requests);
                
                // Update UI
                updateAdminDashboard();
                
                // Show notification
                const statusText = status === 'completed' ? 'تم تنفيذ' : 'تم رفض';
                showNotification(`${statusText} طلب البيع السريع بنجاح`, 'success');
            }
        }
        
        function updateFinancingRequestStatus(id, status) {
            const requests = getFinancingRequests();
            const index = requests.findIndex(req => req.id === id);
            
            if (index !== -1) {
                requests[index].status = status;
                updateFinancingRequests(requests);
                
                // Update UI
                updateAdminDashboard();
                
                // Show notification
                const statusText = status === 'completed' ? 'تم تنفيذ' : 'تم رفض';
                showNotification(`${statusText} طلب التمويل بنجاح`, 'success');
            }
        }
        
        // Admin logout
        const adminLogoutBtn = document.getElementById('adminLogoutBtn');
        adminLogoutBtn.addEventListener('click', function() {
            adminDashboardEl.classList.add('hidden');
            homePageEl.classList.remove('hidden');
            window.history.pushState({page: 'home'}, '', '#');
        });
        
        // Add property
        const addPropertyBtn = document.getElementById('addPropertyBtn');
        addPropertyBtn.addEventListener('click', function() {
            openPropertyModal();
        });
        
        // ----- Agent Dashboard -----
        function updateAgentDashboard(agentId) {
            const properties = filterProperties({ agentId: agentId });
            
            // Update stats
            document.getElementById('agentTotalProperties').textContent = properties.length.toString();
            
            let totalViews = 0;
            properties.forEach(property => {
                totalViews += property.views || 0;
            });
            document.getElementById('agentTotalViews').textContent = totalViews.toString();
            
            // Update properties table
            const agentPropertiesTable = document.getElementById('agentPropertiesTable');
            agentPropertiesTable.innerHTML = '';
            
            if (properties.length === 0) {
                agentPropertiesTable.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-4 text-center text-gray-500">لا توجد عقارات</td>
                    </tr>
                `;
            } else {
                properties.forEach(property => {
                    const formattedPrice = property.operation === 'rent' 
                        ? `${property.price.toLocaleString()} ريال/سنة` 
                        : `${property.price.toLocaleString()} ريال`;
                    
                    let propertyTypeText = '';
                    switch (property.type) {
                        case 'building': propertyTypeText = 'عمائر'; break;
                        case 'villa': propertyTypeText = 'فلل'; break;
                        case 'apartment': propertyTypeText = 'شقق'; break;
                        case 'land': propertyTypeText = 'أراضي'; break;
                        case 'rest': propertyTypeText = 'استراحات'; break;
                        case 'floor': propertyTypeText = 'دور'; break;
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">#${property.id}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${property.title}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${property.location}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-secondary">${formattedPrice}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${propertyTypeText}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2 space-x-reverse">
                                <button class="edit-agent-property text-secondary hover:text-opacity-80 transition duration-300" data-property-id="${property.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="delete-agent-property text-red-500 hover:text-opacity-80 transition duration-300" data-property-id="${property.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    agentPropertiesTable.appendChild(row);
                });
                
                // Attach event listeners
                document.querySelectorAll('.edit-agent-property').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const propertyId = this.getAttribute('data-property-id');
                        openPropertyModal(propertyId, agentId);
                    });
                });
                
                document.querySelectorAll('.delete-agent-property').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const propertyId = this.getAttribute('data-property-id');
                        if (confirm('هل أنت متأكد من حذف هذا العقار؟')) {
                            deleteProperty(propertyId);
                            updateAgentDashboard(agentId);
                        }
                    });
                });
            }
        }
        
        // Agent logout
        const agentLogoutBtn = document.getElementById('agentLogoutBtn');
        agentLogoutBtn.addEventListener('click', function() {
            agentDashboardEl.classList.add('hidden');
            homePageEl.classList.remove('hidden');
            window.history.pushState({page: 'home'}, '', '#');
        });
        
        // Add agent property
        const agentAddPropertyBtn = document.getElementById('agentAddPropertyBtn');
        agentAddPropertyBtn.addEventListener('click', function() {
            const agentId = parseInt(window.history.state.id);
            openPropertyModal(null, agentId);
        });
        
        // ----- Property Modal -----
        function openPropertyModal(propertyId = null, agentId = null) {
            const propertyModalTitle = document.getElementById('propertyModalTitle');
            const propertyFormContent = document.getElementById('propertyFormContent');
            
            // Reset form
            propertyFormContent.reset();
            
            // Update property images section
            updatePropertyImageSelection();
            
            if (propertyId) {
                // Edit existing property
                const property = getPropertyById(propertyId);
                
                propertyModalTitle.textContent = 'تعديل العقار';
                document.getElementById('propertyId').value = property.id;
                document.getElementById('propTitle').value = property.title;
                document.getElementById('propLocation').value = property.location;
                document.getElementById('propPrice').value = property.price;
                document.getElementById('propType').value = property.type;
                document.getElementById('propOperation').value = property.operation;
                document.getElementById('propBedrooms').value = property.bedrooms || '';
                document.getElementById('propBathrooms').value = property.bathrooms || '';
                document.getElementById('propArea').value = property.area || '';
                document.getElementById('propYearBuilt').value = property.yearBuilt || '';
                document.getElementById('propDescription').value = property.description;
                
                // Set amenities
                if (property.amenities) {
                    document.getElementById('amenity1').checked = property.amenities.centralAC || false;
                    document.getElementById('amenity2').checked = property.amenities.pool || false;
                    document.getElementById('amenity3').checked = property.amenities.garden || false;
                    document.getElementById('amenity4').checked = property.amenities.kitchen || false;
                    document.getElementById('amenity5').checked = property.amenities.security || false;
                    document.getElementById('amenity6').checked = property.amenities.nearServices || false;
                }
                
                // Highlight selected images
                property.images.forEach(image => {
                    const imgContainer = document.querySelector(`[data-img-src="${image}"]`);
                    if (imgContainer) {
                        imgContainer.classList.add('ring-2', 'ring-secondary');
                    }
                });
            } else {
                // Add new property
                propertyModalTitle.textContent = 'إضافة عقار جديد';
                document.getElementById('propertyId').value = '';
                
                // If agentId is provided, it means an agent is adding a property
                if (agentId) {
                    document.getElementById('agentId').value = agentId;
                }
            }
            
            propertyModalEl.classList.remove('hidden');
        }
        
        function updatePropertyImageSelection() {
            const propertyImagesContainer = document.getElementById('propertyImages');
            propertyImagesContainer.innerHTML = '';
            
            // Add predefined images for selection
            const propertyImages = [
                'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1628744448839-a475fc846be4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1628624747186-a941c476b7ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1595526114035-0d45ed16cfbf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1560440021-33f9b867899d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80',
                'https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80'
            ];
            
            propertyImages.forEach((image, index) => {
                const imgContainer = document.createElement('div');
                imgContainer.className = 'relative rounded-lg overflow-hidden cursor-pointer transition duration-300';
                imgContainer.setAttribute('data-img-src', image);
                imgContainer.innerHTML = `
                    <img src="${image}" alt="صورة عقار ${index + 1}" class="w-full h-32 object-cover">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold">اختر</span>
                    </div>
                `;
                
                imgContainer.addEventListener('click', function() {
                    this.classList.toggle('ring-2');
                    this.classList.toggle('ring-secondary');
                });
                
                propertyImagesContainer.appendChild(imgContainer);
            });
        }
        
        // Close property modal
        const closePropertyModalBtn = document.getElementById('closePropertyModalBtn');
        closePropertyModalBtn.addEventListener('click', function() {
            propertyModalEl.classList.add('hidden');
        });
        
        // Property form submission
        const propertyFormContent = document.getElementById('propertyFormContent');
        propertyFormContent.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const propertyId = document.getElementById('propertyId').value;
            const title = document.getElementById('propTitle').value;
            const location = document.getElementById('propLocation').value;
            const price = parseInt(document.getElementById('propPrice').value);
            const type = document.getElementById('propType').value;
            const operation = document.getElementById('propOperation').value;
            const bedrooms = parseInt(document.getElementById('propBedrooms').value) || 0;
            const bathrooms = parseInt(document.getElementById('propBathrooms').value) || 0;
            const area = parseInt(document.getElementById('propArea').value) || 0;
            const yearBuilt = parseInt(document.getElementById('propYearBuilt').value) || 0;
            const description = document.getElementById('propDescription').value;
            
            // Get selected images
            const selectedImages = [];
            document.querySelectorAll('#propertyImages .ring-secondary').forEach(img => {
                selectedImages.push(img.getAttribute('data-img-src'));
            });
            
            // Ensure at least one image is selected
            if (selectedImages.length === 0) {
                alert('يرجى اختيار صورة واحدة على الأقل');
                return;
            }
            
            // Get amenities
            const amenities = {
                centralAC: document.getElementById('amenity1').checked,
                pool: document.getElementById('amenity2').checked,
                garden: document.getElementById('amenity3').checked,
                kitchen: document.getElementById('amenity4').checked,
                security: document.getElementById('amenity5').checked,
                nearServices: document.getElementById('amenity6').checked
            };
            
            const propertyData = {
                title,
                location,
                price,
                type,
                operation,
                bedrooms,
                bathrooms,
                area,
                yearBuilt,
                description,
                images: selectedImages,
                amenities
            };
            
            if (propertyId) {
                // Update existing property
                propertyData.id = parseInt(propertyId);
                updateProperty(propertyData);
            } else {
                // Add new property
                // Check if adding from agent dashboard
                const state = window.history.state || {};
                if (state.page === 'agentDashboard' && state.id) {
                    propertyData.agentId = state.id;
                }
                
                addProperty(propertyData);
            }
            
            // Close modal
            propertyModalEl.classList.add('hidden');
            
            // Update dashboard
            if (adminDashboardEl.classList.contains('hidden') === false) {
                updateAdminDashboard();
            } else if (agentDashboardEl.classList.contains('hidden') === false) {
                const state = window.history.state || {};
                if (state.id) {
                    updateAgentDashboard(state.id);
                }
            }
            
            // Update home page if visible
            if (homePageEl.classList.contains('hidden') === false) {
                renderPropertyCards();
            }
        });
        
        // ----- Handle Navigation/History -----
        window.addEventListener('popstate', function(event) {
            const state = event.state || {page: 'home'};
            
            // Hide all pages first
            homePageEl.classList.add('hidden');
            propertyDetailsPageEl.classList.add('hidden');
            adminDashboardEl.classList.add('hidden');
            agentDashboardEl.classList.add('hidden');
            loginFormEl.classList.add('hidden');
            registerFormEl.classList.add('hidden');
            registrationSuccessEl.classList.add('hidden');
            propertyModalEl.classList.add('hidden');
            
            // Show relevant page
            if (state.page === 'propertyDetails' && state.id) {
                propertyDetailsPageEl.classList.remove('hidden');
                showPropertyDetails(state.id);
            } else if (state.page === 'adminDashboard') {
                adminDashboardEl.classList.remove('hidden');
                updateAdminDashboard();
            } else if (state.page === 'agentDashboard' && state.id) {
                agentDashboardEl.classList.remove('hidden');
                updateAgentDashboard(state.id);
            } else {
                homePageEl.classList.remove('hidden');
            }
        });
        
        // ----- Initialization -----
        // Quick Sale Form Event Handlers
        const quickSaleBtn = document.getElementById('quickSaleBtn');
        const quickSaleForm = document.getElementById('quickSaleForm');
        const closeQuickSaleBtn = document.getElementById('closeQuickSaleBtn');
        const quickSaleFormContent = document.getElementById('quickSaleFormContent');
        
        quickSaleBtn.addEventListener('click', function() {
            quickSaleForm.classList.remove('hidden');
        });
        
        closeQuickSaleBtn.addEventListener('click', function() {
            quickSaleForm.classList.add('hidden');
        });
        
        quickSaleFormContent.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const name = document.getElementById('qsName').value;
            const phone = document.getElementById('qsPhone').value;
            const propertyType = document.getElementById('qsPropertyType').value;
            const location = document.getElementById('qsLocation').value;
            const price = document.getElementById('qsPrice').value;
            const notes = document.getElementById('qsNotes').value;
            
            // Create quick sale request object
            const quickSaleRequest = {
                id: Date.now(),
                name,
                phone: `+966${phone}`,
                propertyType,
                location,
                price: Number(price),
                notes,
                date: new Date().toISOString(),
                status: 'pending'
            };
            
            // Save to localStorage
            const quickSaleRequests = JSON.parse(localStorage.getItem('quickSaleRequests') || '[]');
            quickSaleRequests.push(quickSaleRequest);
            localStorage.setItem('quickSaleRequests', JSON.stringify(quickSaleRequests));
            
            // Reset form and close modal
            quickSaleFormContent.reset();
            quickSaleForm.classList.add('hidden');
            
            // Show success notification
            showNotification('تم إرسال طلب البيع السريع بنجاح. سيتم التواصل معك قريبًا.', 'success');
        });
        
        // Financing Form Event Handlers
        const financingBtn = document.getElementById('financingBtn');
        const financingForm = document.getElementById('financingForm');
        const closeFinancingBtn = document.getElementById('closeFinancingBtn');
        const financingFormContent = document.getElementById('financingFormContent');
        
        financingBtn.addEventListener('click', function() {
            financingForm.classList.remove('hidden');
        });
        
        closeFinancingBtn.addEventListener('click', function() {
            financingForm.classList.add('hidden');
        });
        
        financingFormContent.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const name = document.getElementById('finName').value;
            const phone = document.getElementById('finPhone').value;
            const amount = document.getElementById('finAmount').value;
            const salary = document.getElementById('finSalary').value;
            const type = document.getElementById('finType').value;
            const details = document.getElementById('finDetails').value;
            
            // Create financing request object
            const financingRequest = {
                id: Date.now(),
                name,
                phone: `+966${phone}`,
                amount: Number(amount),
                salary: Number(salary),
                type,
                details,
                date: new Date().toISOString(),
                status: 'pending'
            };
            
            // Save to localStorage
            const financingRequests = JSON.parse(localStorage.getItem('financingRequests') || '[]');
            financingRequests.push(financingRequest);
            localStorage.setItem('financingRequests', JSON.stringify(financingRequests));
            
            // Reset form and close modal
            financingFormContent.reset();
            financingForm.classList.add('hidden');
            
            // Show success notification
            showNotification('تم إرسال طلب التمويل بنجاح. سيتم التواصل معك قريبًا.', 'success');
        });

        function init() {
            // Initialize localStorage with default data
            initializeLocalStorage();
            
            // Update visitor count display
            updateVisitorCountDisplay();
            
            // Render property cards
            renderPropertyCards();
            
            // Initialize page state
            window.history.replaceState({page: 'home'}, '', '#');
        }
        
        // Initialize the app
        init();
        
        // ----- Theme Customization -----
        // Initialize theme settings
        function initializeThemeSettings() {
            // Load saved theme if available
            if (localStorage.getItem('aqarak_theme')) {
                try {
                    const theme = JSON.parse(localStorage.getItem('aqarak_theme'));
                    applyTheme(theme);
                } catch (e) {
                    console.error('Error loading theme:', e);
                    // Reset to default if parsing fails
                    resetTheme();
                }
            }
            
            // Initialize tab functionality
            document.getElementById('tabBasicSettings')?.addEventListener('click', function() {
                switchTab('Basic');
            });
            document.getElementById('tabTemplates')?.addEventListener('click', function() {
                switchTab('Templates');
            });
            document.getElementById('tabAdvanced')?.addEventListener('click', function() {
                switchTab('Advanced');
            });
            document.getElementById('tabFonts')?.addEventListener('click', function() {
                switchTab('Fonts');
            });
            
            // Setup color picker events
            document.getElementById('primaryColor')?.addEventListener('input', updateThemePreview);
            document.getElementById('secondaryColor')?.addEventListener('input', updateThemePreview);
            document.getElementById('accentColor')?.addEventListener('input', updateThemePreview);
            document.getElementById('successColor')?.addEventListener('input', updateThemePreview);
            document.getElementById('warningColor')?.addEventListener('input', updateThemePreview);
            document.getElementById('textColor')?.addEventListener('input', updateThemePreview);
            document.getElementById('backgroundColor')?.addEventListener('input', updateThemePreview);
            
            // Setup site name input
            document.getElementById('siteName')?.addEventListener('input', function() {
                document.querySelectorAll('h1.text-2xl.font-bold').forEach(el => {
                    if (el.textContent === 'منصة عقارك') {
                        el.textContent = this.value;
                    }
                });
                document.getElementById('previewTitle').textContent = this.value || 'منصة عقارك';
            });
            
            // Setup border radius options
            document.querySelectorAll('.radius-option').forEach(el => {
                el.addEventListener('click', function() {
                    document.querySelectorAll('.radius-option').forEach(opt => {
                        opt.classList.remove('active', 'bg-secondary', 'text-white');
                    });
                    this.classList.add('active', 'bg-secondary', 'text-white');
                    const radius = this.getAttribute('data-radius');
                    document.documentElement.style.setProperty('--border-radius', `${radius}rem`);
                    updateThemePreview();
                });
            });
            
            // Upload functionality
            document.getElementById('logoUploadBtn')?.addEventListener('click', function() {
                document.getElementById('logoUpload').click();
            });
            
            document.getElementById('logoUpload')?.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const logoPreview = document.getElementById('logoPreview');
                        logoPreview.innerHTML = `<img src="${event.target.result}" class="w-full h-full object-contain">`;
                        
                        // Save to localStorage
                        const theme = getThemeSettings();
                        theme.logo = event.target.result;
                        localStorage.setItem('aqarak_theme', JSON.stringify(theme));
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            document.getElementById('faviconUploadBtn')?.addEventListener('click', function() {
                document.getElementById('faviconUpload').click();
            });
            
            document.getElementById('faviconUpload')?.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const faviconPreview = document.getElementById('faviconPreview');
                        faviconPreview.innerHTML = `<img src="${event.target.result}" class="w-full h-full object-contain">`;
                        
                        // Update favicon
                        let link = document.querySelector("link[rel*='icon']");
                        if (!link) {
                            link = document.createElement('link');
                            link.rel = 'shortcut icon';
                            document.getElementsByTagName('head')[0].appendChild(link);
                        }
                        link.href = event.target.result;
                        
                        // Save to localStorage
                        const theme = getThemeSettings();
                        theme.favicon = event.target.result;
                        localStorage.setItem('aqarak_theme', JSON.stringify(theme));
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Theme control buttons
            document.getElementById('resetTheme')?.addEventListener('click', resetTheme);
            document.getElementById('saveThemeChanges')?.addEventListener('click', saveThemeChanges);
            document.getElementById('cancelThemeChanges')?.addEventListener('click', closeThemeSettings);
            document.getElementById('closeThemeSettings')?.addEventListener('click', closeThemeSettings);
            document.getElementById('exportTheme')?.addEventListener('click', exportTheme);
            document.getElementById('importTheme')?.addEventListener('click', importTheme);
            
            // Templates functionality
            document.querySelectorAll('.apply-template').forEach(btn => {
                btn.addEventListener('click', function() {
                    const templateName = this.getAttribute('data-template');
                    applyTemplate(templateName);
                });
            });
            
            // Font previews
            document.getElementById('mainFont')?.addEventListener('change', updateFontPreview);
            document.getElementById('headingFont')?.addEventListener('change', updateFontPreview);
            document.getElementById('fontSize')?.addEventListener('change', updateFontPreview);
            document.getElementById('fontWeight')?.addEventListener('change', updateFontPreview);
            document.getElementById('addCustomFont')?.addEventListener('click', addCustomFont);
            
            // Select settings
            document.getElementById('menuStyle')?.addEventListener('change', updateThemePreview);
            document.getElementById('footerStyle')?.addEventListener('change', updateThemePreview);
            document.getElementById('cardStyle')?.addEventListener('change', updateThemePreview);
            document.getElementById('animationStyle')?.addEventListener('change', updateThemePreview);
            document.getElementById('shadowStyle')?.addEventListener('change', updateThemePreview);
            document.getElementById('spacing')?.addEventListener('change', updateThemePreview);
            document.getElementById('detailPageStyle')?.addEventListener('change', updateThemePreview);
            document.getElementById('galleryStyle')?.addEventListener('change', updateThemePreview);
            
            // Admin and buttons
            if (document.getElementById('adminThemeBtn')) {
                document.getElementById('adminThemeBtn').addEventListener('click', openThemeSettings);
            }
            if (document.getElementById('adminThemeBtn2')) {
                document.getElementById('adminThemeBtn2').addEventListener('click', openThemeSettings);
            }
            
            // Initialize with first tab active
            switchTab('Basic');
        }
        
        function switchTab(tabName) {
            // Hide all tab contents
            document.getElementById('tabContentBasic').classList.add('hidden');
            document.getElementById('tabContentTemplates').classList.add('hidden');
            document.getElementById('tabContentAdvanced').classList.add('hidden');
            document.getElementById('tabContentFonts').classList.add('hidden');
            
            // Reset all tab buttons
            document.getElementById('tabBasicSettings').classList.remove('text-primary', 'border-b-2', 'border-primary');
            document.getElementById('tabTemplates').classList.remove('text-primary', 'border-b-2', 'border-primary');
            document.getElementById('tabAdvanced').classList.remove('text-primary', 'border-b-2', 'border-primary');
            document.getElementById('tabFonts').classList.remove('text-primary', 'border-b-2', 'border-primary');
            
            document.getElementById('tabBasicSettings').classList.add('text-gray-500');
            document.getElementById('tabTemplates').classList.add('text-gray-500');
            document.getElementById('tabAdvanced').classList.add('text-gray-500');
            document.getElementById('tabFonts').classList.add('text-gray-500');
            
            // Show selected tab and update button
            document.getElementById('tabContent' + tabName).classList.remove('hidden');
            document.getElementById('tab' + tabName).classList.remove('text-gray-500');
            document.getElementById('tab' + tabName).classList.add('text-primary', 'border-b-2', 'border-primary');
        }
        
        function updateFontPreview() {
            const mainFont = document.getElementById('mainFont')?.value || 'Cairo, sans-serif';
            const headingFont = document.getElementById('headingFont')?.value || 'Cairo, sans-serif';
            const fontSize = document.getElementById('fontSize')?.value || 'medium';
            const fontWeight = document.getElementById('fontWeight')?.value || 'normal';
            
            let fontSizeValue = '1rem';
            if (fontSize === 'small') fontSizeValue = '0.875rem';
            if (fontSize === 'large') fontSizeValue = '1.125rem';
            
            let fontWeightValue = '400';
            if (fontWeight === 'medium') fontWeightValue = '500';
            if (fontWeight === 'bold') fontWeightValue = '700';
            
            const previewText = document.getElementById('fontPreviewText');
            const previewHeading = document.getElementById('fontPreviewHeading');
            
            if (previewText) {
                previewText.style.fontFamily = mainFont;
                previewText.style.fontSize = fontSizeValue;
                previewText.style.fontWeight = fontWeightValue;
            }
            
            if (previewHeading) {
                previewHeading.style.fontFamily = headingFont;
            }
            
            // Update theme settings
            document.documentElement.style.setProperty('--font-family', mainFont);
            document.documentElement.style.setProperty('--heading-font-family', headingFont);
            document.documentElement.style.setProperty('--font-size-base', fontSizeValue);
            document.documentElement.style.setProperty('--font-weight', fontWeightValue);
        }
        
        function addCustomFont() {
            const customFontURL = document.getElementById('customFontURL')?.value;
            if (!customFontURL) return;
            
            // Create a new link element
            const linkElement = document.createElement('link');
            linkElement.rel = 'stylesheet';
            linkElement.href = customFontURL;
            
            // Add it to the head
            document.head.appendChild(linkElement);
            
            // Show success message
            showToast('تم إضافة الخط بنجاح', 'success');
            
            // Clear the input
            document.getElementById('customFontURL').value = '';
        }
        
        function applyTemplate(templateName) {
            let theme = {};
            
            switch(templateName) {
                case 'modern':
                    theme = {
                        primary: '#1565C0',
                        secondary: '#2196F3',
                        accent: '#FF4081',
                        success: '#4CAF50',
                        warning: '#FFC107',
                        textColor: '#333333',
                        backgroundColor: '#F5F7FA',
                        borderRadius: '0.5',
                        fontFamily: 'Cairo, sans-serif',
                        headingFont: 'Cairo, sans-serif',
                        menuStyle: 'standard',
                        footerStyle: 'standard',
                        cardStyle: 'modern',
                        animationStyle: 'fade'
                    };
                    break;
                case 'luxury':
                    theme = {
                        primary: '#212121',
                        secondary: '#424242',
                        accent: '#D4AF37',
                        success: '#388E3C',
                        warning: '#FFA000',
                        textColor: '#212121',
                        backgroundColor: '#F5F5F5',
                        borderRadius: '0',
                        fontFamily: 'Tajawal, sans-serif',
                        headingFont: 'Tajawal, sans-serif',
                        menuStyle: 'centered',
                        footerStyle: 'expanded',
                        cardStyle: 'minimal',
                        animationStyle: 'fade'
                    };
                    break;
                case 'classic':
                    theme = {
                        primary: '#2E7D32',
                        secondary: '#4CAF50',
                        accent: '#FFA000',
                        success: '#388E3C',
                        warning: '#FF9800',
                        textColor: '#333333',
                        backgroundColor: '#FAFAFA',
                        borderRadius: '0.25',
                        fontFamily: 'Amiri, serif',
                        headingFont: 'Amiri, serif',
                        menuStyle: 'standard',
                        footerStyle: 'compact',
                        cardStyle: 'standard',
                        animationStyle: 'none'
                    };
                    break;
                case 'minimalist':
                    theme = {
                        primary: '#455A64',
                        secondary: '#607D8B',
                        accent: '#78909C',
                        success: '#66BB6A',
                        warning: '#FFD54F',
                        textColor: '#37474F',
                        backgroundColor: '#FFFFFF',
                        borderRadius: '0.25',
                        fontFamily: 'Tajawal, sans-serif',
                        headingFont: 'Tajawal, sans-serif',
                        menuStyle: 'hamburger',
                        footerStyle: 'compact',
                        cardStyle: 'minimal',
                        animationStyle: 'fade'
                    };
                    break;
                case 'vibrant':
                    theme = {
                        primary: '#6A1B9A',
                        secondary: '#9C27B0',
                        accent: '#EC407A',
                        success: '#43A047',
                        warning: '#FFA726',
                        textColor: '#333333',
                        backgroundColor: '#F3E5F5',
                        borderRadius: '1',
                        fontFamily: 'Changa, sans-serif',
                        headingFont: 'Changa, sans-serif',
                        menuStyle: 'standard',
                        footerStyle: 'expanded',
                        cardStyle: 'modern',
                        animationStyle: 'bounce'
                    };
                    break;
                case 'warm':
                    theme = {
                        primary: '#E65100',
                        secondary: '#FF9800',
                        accent: '#FFAB00',
                        success: '#43A047',
                        warning: '#FF6F00',
                        textColor: '#4E342E',
                        backgroundColor: '#FFF3E0',
                        borderRadius: '0.5',
                        fontFamily: 'El Messiri, sans-serif',
                        headingFont: 'El Messiri, sans-serif',
                        menuStyle: 'centered',
                        footerStyle: 'standard',
                        cardStyle: 'standard',
                        animationStyle: 'slide'
                    };
                    break;
            }
            
            // Update form inputs
            document.getElementById('primaryColor').value = theme.primary;
            document.getElementById('secondaryColor').value = theme.secondary;
            document.getElementById('accentColor').value = theme.accent;
            document.getElementById('successColor').value = theme.success;
            document.getElementById('warningColor').value = theme.warning;
            document.getElementById('textColor').value = theme.textColor;
            document.getElementById('backgroundColor').value = theme.backgroundColor;
            
            // Update radius option
            document.querySelectorAll('.radius-option').forEach(el => {
                el.classList.remove('active', 'bg-secondary', 'text-white');
                if (el.getAttribute('data-radius') === theme.borderRadius) {
                    el.classList.add('active', 'bg-secondary', 'text-white');
                }
            });
            
            // Update selects
            if (document.getElementById('mainFont')) document.getElementById('mainFont').value = theme.fontFamily;
            if (document.getElementById('headingFont')) document.getElementById('headingFont').value = theme.headingFont;
            if (document.getElementById('menuStyle')) document.getElementById('menuStyle').value = theme.menuStyle;
            if (document.getElementById('footerStyle')) document.getElementById('footerStyle').value = theme.footerStyle;
            if (document.getElementById('cardStyle')) document.getElementById('cardStyle').value = theme.cardStyle;
            if (document.getElementById('animationStyle')) document.getElementById('animationStyle').value = theme.animationStyle;
            
            // Apply theme preview
            updateThemePreview();
            updateFontPreview();
            
            // Show success toast
            showToast('تم تطبيق القالب بنجاح', 'success');
        }
        
        function exportTheme() {
            const theme = getThemeSettings();
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(theme));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "aqarak_theme.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            showToast('تم تصدير التصميم بنجاح', 'success');
        }
        
        function importTheme() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = event => {
                    try {
                        const theme = JSON.parse(event.target.result);
                        applyTheme(theme);
                        showToast('تم استيراد التصميم بنجاح', 'success');
                    } catch (e) {
                        console.error('Error importing theme:', e);
                        showToast('حدث خطأ أثناء استيراد التصميم', 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function getThemeSettings() {
            return {
                primary: document.getElementById('primaryColor')?.value || '#2C3E50',
                secondary: document.getElementById('secondaryColor')?.value || '#3498DB',
                accent: document.getElementById('accentColor')?.value || '#E74C3C',
                success: document.getElementById('successColor')?.value || '#28A745',
                warning: document.getElementById('warningColor')?.value || '#FFC107',
                siteName: document.getElementById('siteName')?.value || 'منصة عقارك',
                borderRadius: document.querySelector('.radius-option.active')?.getAttribute('data-radius') || '0.5',
                logo: document.getElementById('logoPreview')?.querySelector('img')?.src || null
            };
        }
        
        function updateThemePreview() {
            // Update color previews
            if (document.getElementById('previewPrimary')) document.getElementById('previewPrimary').style.backgroundColor = document.getElementById('primaryColor').value;
            if (document.getElementById('previewSecondary')) document.getElementById('previewSecondary').style.backgroundColor = document.getElementById('secondaryColor').value;
            if (document.getElementById('previewAccent')) document.getElementById('previewAccent').style.backgroundColor = document.getElementById('accentColor').value;
            if (document.getElementById('previewSuccess')) document.getElementById('previewSuccess').style.backgroundColor = document.getElementById('successColor').value;
            if (document.getElementById('previewWarning')) document.getElementById('previewWarning').style.backgroundColor = document.getElementById('warningColor').value;
            
            // Update button previews
            if (document.getElementById('previewBtn1')) document.getElementById('previewBtn1').style.backgroundColor = document.getElementById('primaryColor').value;
            if (document.getElementById('previewBtn2')) document.getElementById('previewBtn2').style.backgroundColor = document.getElementById('secondaryColor').value;
            if (document.getElementById('previewBtn3')) document.getElementById('previewBtn3').style.backgroundColor = document.getElementById('accentColor').value;
            if (document.getElementById('previewBtn4')) document.getElementById('previewBtn4').style.background = `linear-gradient(135deg, ${document.getElementById('primaryColor').value}, ${document.getElementById('secondaryColor').value})`;
            
            // Update text preview
            if (document.getElementById('previewTitle')) document.getElementById('previewTitle').style.color = document.getElementById('primaryColor').value;
        }
        
        function applyTheme(theme) {
            if (!theme) return;
            
            // Apply colors through CSS variables
            document.documentElement.style.setProperty('--color-primary', theme.primary || '#2C3E50');
            document.documentElement.style.setProperty('--color-secondary', theme.secondary || '#3498DB');
            document.documentElement.style.setProperty('--color-accent', theme.accent || '#E74C3C');
            document.documentElement.style.setProperty('--color-success', theme.success || '#28A745');
            document.documentElement.style.setProperty('--color-warning', theme.warning || '#FFC107');
            document.documentElement.style.setProperty('--border-radius', `${theme.borderRadius || 0.5}rem`);
            
            // Update form inputs to match current theme
            if (document.getElementById('primaryColor')) document.getElementById('primaryColor').value = theme.primary || '#2C3E50';
            if (document.getElementById('secondaryColor')) document.getElementById('secondaryColor').value = theme.secondary || '#3498DB';
            if (document.getElementById('accentColor')) document.getElementById('accentColor').value = theme.accent || '#E74C3C';
            if (document.getElementById('successColor')) document.getElementById('successColor').value = theme.success || '#28A745';
            if (document.getElementById('warningColor')) document.getElementById('warningColor').value = theme.warning || '#FFC107';
            if (document.getElementById('siteName')) document.getElementById('siteName').value = theme.siteName || 'منصة عقارك';
            
            // Update site name
            document.querySelectorAll('h1.text-2xl.font-bold').forEach(el => {
                if (el.textContent === 'منصة عقارك' || el.textContent === theme.siteName) {
                    el.textContent = theme.siteName || 'منصة عقارك';
                }
            });
            
            // Update logo if exists
            if (theme.logo && document.getElementById('logoPreview')) {
                const logoPreview = document.getElementById('logoPreview');
                logoPreview.innerHTML = `<img src="${theme.logo}" class="w-full h-full object-contain">`;
            }
            
            // Update border radius option selection
            document.querySelectorAll('.radius-option').forEach(el => {
                el.classList.remove('active', 'bg-secondary', 'text-white');
                if (el.getAttribute('data-radius') === (theme.borderRadius || '0.5')) {
                    el.classList.add('active', 'bg-secondary', 'text-white');
                }
            });
            
            // Update preview
            updateThemePreview();
        }
        
        function resetTheme() {
            const defaultTheme = {
                primary: '#2C3E50',
                secondary: '#3498DB',
                accent: '#E74C3C',
                success: '#28A745',
                warning: '#FFC107',
                siteName: 'النخبة العقارية',
                borderRadius: '0.5'
            };
            
            applyTheme(defaultTheme);
            
            // Reset logo
            if (document.getElementById('logoPreview')) {
                const logoPreview = document.getElementById('logoPreview');
                logoPreview.innerHTML = '<i class="fas fa-building text-4xl text-gray-400"></i>';
            }
            
            // Update localStorage
            localStorage.setItem('aqarak_theme', JSON.stringify(defaultTheme));
        }
        
        function saveThemeChanges() {
            const theme = getThemeSettings();
            localStorage.setItem('aqarak_theme', JSON.stringify(theme));
            applyTheme(theme);
            closeThemeSettings();
            
            // Show success toast
            showToast('تم حفظ إعدادات التصميم بنجاح', 'success');
        }
        
        function openThemeSettings() {
            if (document.getElementById('themeSettingsModal')) {
                document.getElementById('themeSettingsModal').classList.remove('hidden');
            }
        }
        
        function closeThemeSettings() {
            if (document.getElementById('themeSettingsModal')) {
                document.getElementById('themeSettingsModal').classList.add('hidden');
            }
        }
        
        // Toast notification system
        function showToast(message, type = 'info') {
            // Create toast element
            const toast = document.createElement('div');
            toast.className = 'fixed left-0 right-0 mx-auto w-full max-w-sm p-4 bg-white rounded-lg shadow-lg mt-4 animate-fadeInUp z-50';
            toast.style.top = '20px';
            toast.style.zIndex = '9999';
            
            // Determine icon and color
            let iconClass, bgColorClass;
            switch (type) {
                case 'success':
                    iconClass = 'fa-check-circle';
                    bgColorClass = 'bg-success';
                    break;
                case 'error':
                    iconClass = 'fa-exclamation-circle';
                    bgColorClass = 'bg-accent';
                    break;
                case 'warning':
                    iconClass = 'fa-exclamation-triangle';
                    bgColorClass = 'bg-warning';
                    break;
                default:
                    iconClass = 'fa-info-circle';
                    bgColorClass = 'bg-secondary';
                    break;
            }
            
            // Set content
            toast.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="${bgColorClass} bg-opacity-20 p-2 rounded-full ml-3">
                            <i class="fas ${iconClass} text-${type === 'warning' ? 'warning' : type === 'success' ? 'success' : type === 'error' ? 'accent' : 'secondary'}"></i>
                        </div>
                        <p class="text-gray-800">${message}</p>
                    </div>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            // Add to DOM
            document.body.appendChild(toast);
            
            // Add close functionality
            toast.querySelector('button').addEventListener('click', function() {
                toast.remove();
            });
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                toast.classList.add('opacity-0', 'transition', 'duration-300');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // Initialize theme customization when ready
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeThemeSettings, 500);
            
            // المصادقة ونوافذ تسجيل الدخول
            document.getElementById('loginBtn').addEventListener('click', function() {
                showLoginModal();
            });
            
            // إغلاق النوافذ المنبثقة عند النقر على زر الإغلاق
            document.querySelectorAll('.close-modal').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.modal').forEach(function(modal) {
                        modal.classList.add('hidden');
                    });
                });
            });
            
            // إغلاق النوافذ المنبثقة عند النقر خارج النافذة
            document.querySelectorAll('.modal').forEach(function(modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.add('hidden');
                    }
                });
            });
            
            // التبديل بين علامات تبويب تسجيل الدخول
            document.querySelectorAll('.login-tab').forEach(function(tab) {
                tab.addEventListener('click', function() {
                    // إزالة الحالة النشطة من جميع علامات التبويب
                    document.querySelectorAll('.login-tab').forEach(function(t) {
                        t.classList.remove('border-b-2', 'border-primary', 'text-primary');
                        t.classList.add('text-gray-500');
                    });
                    
                    // إضافة الحالة النشطة إلى علامة التبويب التي تم النقر عليها
                    this.classList.add('border-b-2', 'border-primary', 'text-primary');
                    this.classList.remove('text-gray-500');
                    
                    // إخفاء جميع محتويات علامات التبويب
                    document.querySelectorAll('.login-tab-content').forEach(function(content) {
                        content.classList.add('hidden');
                    });
                    
                    // إظهار المحتوى المقابل
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.remove('hidden');
                });
            });
            
            // فتح نافذة المسؤول
            document.getElementById('adminLoginLink').addEventListener('click', function() {
                document.getElementById('mainLoginModal').classList.add('hidden');
                document.getElementById('adminLoginModal').classList.remove('hidden');
            });
            
            // ربط أحداث نماذج تسجيل الدخول
            document.querySelectorAll('.login-form').forEach(function(form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    // يمكن إضافة منطق المصادقة هنا
                    showNotification('success', 'تم تسجيل الدخول بنجاح');
                    document.querySelectorAll('.modal').forEach(function(modal) {
                        modal.classList.add('hidden');
                    });
                });
            });
        });
    })();
    </script>
    
    <!-- نوافذ تسجيل الدخول -->
    <!-- نافذة تسجيل دخول المسؤول -->
    <div id="adminLoginModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-primary text-white">
                <h3 class="text-xl font-bold">تسجيل دخول المسؤول</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="p-6 space-y-4 login-form">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">اسم المستخدم</label>
                    <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل اسم المستخدم" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                    <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل كلمة المرور" required>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input type="checkbox" id="rememberAdmin" class="h-4 w-4 text-primary border-gray-300 rounded">
                        <label for="rememberAdmin" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                    </div>
                </div>
                <button type="submit" class="w-full py-3 bg-primary text-white rounded-md hover:bg-opacity-90 transition">
                    تسجيل دخول المسؤول
                </button>
            </form>
        </div>
    </div>

    <!-- نافذة تسجيل دخول الوسيط -->
    <div id="brokerLoginModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-secondary text-white">
                <h3 class="text-xl font-bold">تسجيل دخول الوسيط العقاري</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="p-6 space-y-4 login-form">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                    <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                    <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="أدخل كلمة المرور" required>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input type="checkbox" id="rememberBroker" class="h-4 w-4 text-secondary border-gray-300 rounded">
                        <label for="rememberBroker" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                    </div>
                    <a href="#" class="text-sm text-secondary hover:underline">نسيت كلمة المرور؟</a>
                </div>
                <button type="submit" class="w-full py-3 bg-secondary text-white rounded-md hover:bg-opacity-90 transition">
                    تسجيل دخول الوسيط
                </button>
                <div class="text-center text-sm text-gray-600">
                    ليس لديك حساب؟ <a href="#" id="registerBrokerLink" class="text-secondary hover:underline">تسجيل كوسيط عقاري</a>
                </div>
            </form>
        </div>
    </div>

    <!-- نافذة تسجيل دخول المحامي -->
    <div id="lawyerLoginModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-success text-white">
                <h3 class="text-xl font-bold">تسجيل دخول المحامي</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="p-6 space-y-4 login-form">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                    <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                    <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل كلمة المرور" required>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input type="checkbox" id="rememberLawyer" class="h-4 w-4 text-success border-gray-300 rounded">
                        <label for="rememberLawyer" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                    </div>
                    <a href="#" class="text-sm text-success hover:underline">نسيت كلمة المرور؟</a>
                </div>
                <button type="submit" class="w-full py-3 bg-success text-white rounded-md hover:bg-opacity-90 transition">
                    تسجيل دخول المحامي
                </button>
                <div class="text-center text-sm text-gray-600 mt-4 p-3 bg-gray-100 rounded-md">
                    <p><i class="fas fa-info-circle ml-1"></i> يتم إنشاء حسابات المحامين من قبل مسؤول النظام فقط</p>
                </div>
            </form>
        </div>
    </div>

    <!-- نافذة تسجيل دخول جهة التمويل -->
    <div id="financeLoginModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-accent text-white">
                <h3 class="text-xl font-bold">تسجيل دخول جهة التمويل</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="p-6 space-y-4 login-form">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                    <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                    <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل كلمة المرور" required>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input type="checkbox" id="rememberFinance" class="h-4 w-4 text-accent border-gray-300 rounded">
                        <label for="rememberFinance" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                    </div>
                    <a href="#" class="text-sm text-accent hover:underline">نسيت كلمة المرور؟</a>
                </div>
                <button type="submit" class="w-full py-3 bg-accent text-white rounded-md hover:bg-opacity-90 transition">
                    تسجيل دخول جهة التمويل
                </button>
                <div class="text-center text-sm text-gray-600 mt-4 p-3 bg-gray-100 rounded-md">
                    <p><i class="fas fa-info-circle ml-1"></i> يتم إنشاء حسابات جهات التمويل من قبل مسؤول النظام فقط</p>
                </div>
            </form>
        </div>
    </div>

    <!-- نافذة تسجيل الدخول الرئيسية مع علامات تبويب لجميع أنواع المستخدمين -->
    <div id="mainLoginModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between">
                <h3 class="text-xl font-bold text-primary">تسجيل الدخول</h3>
                <button class="close-modal text-gray-500 hover:text-gray-700 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- علامات تبويب تسجيل الدخول -->
            <div class="flex border-b">
                <button data-tab="userTab" class="login-tab w-1/4 px-4 py-3 text-center font-medium border-b-2 border-primary text-primary">
                    مسؤول
                </button>
                <button data-tab="brokerTab" class="login-tab w-1/4 px-4 py-3 text-center font-medium text-gray-500">
                    وسيط
                </button>
                <button data-tab="lawyerTab" class="login-tab w-1/4 px-4 py-3 text-center font-medium text-gray-500">
                    محامي
                </button>
                <button data-tab="financeTab" class="login-tab w-1/4 px-4 py-3 text-center font-medium text-gray-500">
                    تمويل
                </button>
            </div>
            
            <!-- محتويات علامات التبويب -->
            <div id="userTab" class="login-tab-content">
                <form class="p-6 space-y-4 login-form">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                        <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                        <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل كلمة المرور" required>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input type="checkbox" id="rememberUser" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="rememberUser" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                        </div>
                        <a href="#" class="text-sm text-primary hover:underline">نسيت كلمة المرور؟</a>
                    </div>
                    <button type="submit" class="w-full py-3 bg-primary text-white rounded-md hover:bg-opacity-90 transition">
                        تسجيل دخول المسؤول
                    </button>
                    <div class="text-center text-sm text-gray-600">
                        ليس لديك حساب؟ <a href="#" class="text-primary hover:underline">إنشاء حساب جديد</a>
                    </div>
                </form>
            </div>
            
            <div id="brokerTab" class="login-tab-content hidden">
                <form class="p-6 space-y-4 login-form">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                        <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                        <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="أدخل كلمة المرور" required>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input type="checkbox" id="rememberBroker2" class="h-4 w-4 text-secondary border-gray-300 rounded">
                            <label for="rememberBroker2" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                        </div>
                        <a href="#" class="text-sm text-secondary hover:underline">نسيت كلمة المرور؟</a>
                    </div>
                    <button type="submit" class="w-full py-3 bg-secondary text-white rounded-md hover:bg-opacity-90 transition">
                        تسجيل دخول الوسيط
                    </button>
                    <div class="text-center text-sm text-gray-600">
                        ليس لديك حساب؟ <a href="#" id="registerBrokerLink2" class="text-secondary hover:underline">تسجيل كوسيط عقاري</a>
                    </div>
                </form>
            </div>
            
            <div id="lawyerTab" class="login-tab-content hidden">
                <form class="p-6 space-y-4 login-form">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                        <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                        <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل كلمة المرور" required>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input type="checkbox" id="rememberLawyer2" class="h-4 w-4 text-success border-gray-300 rounded">
                            <label for="rememberLawyer2" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                        </div>
                        <a href="#" class="text-sm text-success hover:underline">نسيت كلمة المرور؟</a>
                    </div>
                    <button type="submit" class="w-full py-3 bg-success text-white rounded-md hover:bg-opacity-90 transition">
                        تسجيل دخول المحامي
                    </button>
                    <div class="text-center text-sm text-gray-600 mt-4 p-3 bg-gray-100 rounded-md">
                        <p><i class="fas fa-info-circle ml-1"></i> يتم إنشاء حسابات المحامين من قبل مسؤول النظام فقط</p>
                    </div>
                </form>
            </div>
            
            <div id="financeTab" class="login-tab-content hidden">
                <form class="p-6 space-y-4 login-form">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني أو اسم المستخدم</label>
                        <input type="text" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل البريد الإلكتروني أو اسم المستخدم" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                        <input type="password" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل كلمة المرور" required>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input type="checkbox" id="rememberFinance2" class="h-4 w-4 text-accent border-gray-300 rounded">
                            <label for="rememberFinance2" class="mr-2 block text-sm text-gray-700">تذكرني</label>
                        </div>
                        <a href="#" class="text-sm text-accent hover:underline">نسيت كلمة المرور؟</a>
                    </div>
                    <button type="submit" class="w-full py-3 bg-accent text-white rounded-md hover:bg-opacity-90 transition">
                        تسجيل دخول جهة التمويل
                    </button>
                    <div class="text-center text-sm text-gray-600 mt-4 p-3 bg-gray-100 rounded-md">
                        <p><i class="fas fa-info-circle ml-1"></i> يتم إنشاء حسابات جهات التمويل من قبل مسؤول النظام فقط</p>
                    </div>
                </form>
            </div>
            
            <!-- رابط تسجيل دخول المسؤول -->
            <div class="p-6 text-center border-t">
                <button id="adminLoginLink" class="text-sm text-gray-600 hover:text-primary">
                    تسجيل دخول المسؤول
                </button>
            </div>
        </div>
    </div>
    
    <!-- نموذج تسجيل الوسطاء -->
    <div id="brokerRegisterModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-secondary text-white">
                <h3 class="text-xl font-bold">تسجيل وسيط عقاري جديد</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="brokerRegisterForm" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">الاسم الكامل</label>
                    <input type="text" id="brokerName" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="أدخل اسمك الكامل" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">رقم الواتساب</label>
                    <input type="text" id="brokerWhatsapp" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="مثال: 5XXXXXXXX" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">رقم رخصة الوسيط العقاري</label>
                    <input type="text" id="brokerLicense" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="مثال: RT-12345" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني</label>
                    <input type="email" id="brokerEmail" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-secondary" placeholder="أدخل بريدك الإلكتروني" required>
                </div>
                <div class="bg-gray-100 p-3 rounded-md text-sm text-gray-600">
                    <p><i class="fas fa-info-circle ml-1"></i> بعد التسجيل، سيتم مراجعة طلبك من قبل المشرف وسيتم إرسال بيانات الدخول على البريد الإلكتروني المسجل.</p>
                </div>
                <button type="submit" class="w-full py-3 bg-secondary text-white rounded-md hover:bg-opacity-90 transition">
                    تسجيل كوسيط عقاري
                </button>
            </form>
        </div>
    </div>

    <!-- نموذج إضافة محامي -->
    <div id="addLawyerModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-success text-white">
                <h3 class="text-xl font-bold">إضافة محامي جديد</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addLawyerForm" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">الاسم الكامل</label>
                    <input type="text" id="lawyerName" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل اسم المحامي الكامل" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني</label>
                    <input type="email" id="lawyerEmail" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل البريد الإلكتروني" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">رقم الهاتف</label>
                    <input type="text" id="lawyerPhone" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="مثال: 05XXXXXXXX" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                    <input type="password" id="lawyerPassword" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-success focus:border-success" placeholder="أدخل كلمة المرور" required>
                </div>
                <button type="submit" class="w-full py-3 bg-success text-white rounded-md hover:bg-opacity-90 transition">
                    إضافة المحامي
                </button>
            </form>
        </div>
    </div>

    <!-- نموذج إضافة جهة تمويل -->
    <div id="addFinanceModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-md animate-fadeInUp">
            <div class="border-b p-4 flex items-center justify-between bg-accent text-white">
                <h3 class="text-xl font-bold">إضافة جهة تمويل جديدة</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addFinanceForm" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">اسم الجهة</label>
                    <input type="text" id="financeName" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل اسم جهة التمويل" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">البريد الإلكتروني</label>
                    <input type="email" id="financeEmail" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل البريد الإلكتروني" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">رقم الهاتف</label>
                    <input type="text" id="financePhone" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="مثال: 05XXXXXXXX" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">كلمة المرور</label>
                    <input type="password" id="financePassword" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-accent focus:border-accent" placeholder="أدخل كلمة المرور" required>
                </div>
                <button type="submit" class="w-full py-3 bg-accent text-white rounded-md hover:bg-opacity-90 transition">
                    إضافة جهة التمويل
                </button>
            </form>
        </div>
    </div>
    
    <!-- نموذج إضافة عقار جديد -->
    <div id="addPropertyModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-5xl h-90vh animate-fadeInUp overflow-y-auto">
            <div class="border-b p-4 flex items-center justify-between bg-primary text-white sticky top-0 z-10">
                <h3 class="text-xl font-bold">إضافة عقار جديد</h3>
                <button class="close-modal text-white hover:text-gray-200 focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addPropertyForm" class="p-6">
                <!-- المعلومات الأساسية -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-primary mb-4 border-b pb-2">المعلومات الأساسية</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">عنوان العقار</label>
                            <input type="text" id="propertyTitle" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل عنوان العقار" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">السعر</label>
                            <input type="number" id="propertyPrice" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل السعر" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">نوع العقار</label>
                            <select id="propertyTypeSelect" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" required>
                                <option value="">اختر نوع العقار</option>
                                <option value="building">عمائر</option>
                                <option value="villa">فلل</option>
                                <option value="apartment">شقق</option>
                                <option value="land">أراضي</option>
                                <option value="palace">قصور</option>
                                <option value="rest">استراحات</option>
                                <option value="floor">دور</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">نوع العملية</label>
                            <select id="propertyOperation" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" required>
                                <option value="">اختر نوع العملية</option>
                                <option value="sale">بيع</option>
                                <option value="rent">إيجار</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- معلومات الموقع -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-primary mb-4 border-b pb-2">معلومات الموقع</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">المنطقة</label>
                            <select id="propertyRegion" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary">
                                <option value="">اختر المنطقة</option>
                                <option value="riyadh">الرياض</option>
                                <option value="jeddah">جدة</option>
                                <option value="makkah">مكة المكرمة</option>
                                <option value="madinah">المدينة المنورة</option>
                                <option value="taif">الطائف</option>
                                <option value="dammam">الدمام</option>
                                <option value="khobar">الخبر</option>
                                <option value="abha">أبها</option>
                                <option value="tabuk">تبوك</option>
                                <option value="qassim">القصيم</option>
                                <option value="hail">حائل</option>
                                <option value="jazan">جازان</option>
                                <option value="najran">نجران</option>
                                <option value="custom">منطقة أخرى...</option>
                            </select>
                        </div>
                        <div id="customPropertyRegionContainer" style="display: none;">
                            <label class="block text-sm font-medium text-gray-700 mb-1">اكتب اسم المنطقة</label>
                            <input type="text" id="customPropertyRegion" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل اسم المنطقة">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">الحي</label>
                            <input type="text" id="propertyDistrict" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل اسم الحي" required>
                        </div>
                    </div>
                </div>

                <!-- مواصفات العقار -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-primary mb-4 border-b pb-2">مواصفات العقار</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">المساحة (متر مربع)</label>
                            <input type="number" id="propertyArea" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل المساحة" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">عدد الغرف</label>
                            <input type="number" id="propertyRooms" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل عدد الغرف">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">عدد الحمامات</label>
                            <input type="number" id="propertyBathrooms" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل عدد الحمامات">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">عمر العقار (سنة)</label>
                            <input type="number" id="propertyAge" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل عمر العقار">
                        </div>
                    </div>
                </div>
                
                <!-- المزايا -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-primary mb-4 border-b pb-2">مزايا العقار</h4>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <div class="flex items-center">
                            <input type="checkbox" id="amenityCentralAC" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="amenityCentralAC" class="mr-2 block text-sm text-gray-700">تكييف مركزي</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="amenityPool" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="amenityPool" class="mr-2 block text-sm text-gray-700">مسبح</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="amenityGarden" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="amenityGarden" class="mr-2 block text-sm text-gray-700">حديقة</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="amenityKitchen" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="amenityKitchen" class="mr-2 block text-sm text-gray-700">مطبخ</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="amenitySecurity" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="amenitySecurity" class="mr-2 block text-sm text-gray-700">نظام أمان</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="amenityNearServices" class="h-4 w-4 text-primary border-gray-300 rounded">
                            <label for="amenityNearServices" class="mr-2 block text-sm text-gray-700">قريب من الخدمات</label>
                        </div>
                    </div>
                </div>
                
                <!-- الوصف -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-primary mb-4 border-b pb-2">وصف العقار</h4>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">وصف العقار</label>
                        <textarea id="propertyDescription" rows="4" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="أدخل وصف العقار" required></textarea>
                    </div>
                </div>
                
                <!-- الصور -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-primary mb-4 border-b pb-2">صور العقار</h4>
                    <div class="bg-gray-50 p-4 rounded-lg border border-dashed border-gray-300 text-center">
                        <label for="propertyImages" class="cursor-pointer">
                            <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                            <p class="text-sm text-gray-600 mb-1">اسحب الصور هنا أو انقر للاختيار</p>
                            <p class="text-xs text-gray-500">يمكنك تحميل حتى 5 صور</p>
                            <input type="file" id="propertyImages" class="hidden" multiple accept="image/*">
                        </label>
                    </div>
                    <div id="imagesPreviewContainer" class="mt-4 flex flex-wrap gap-4">
                        <!-- صور العقار ستظهر هنا -->
                    </div>
                </div>
                
                <div class="text-center">
                    <button type="submit" class="bg-primary hover:bg-opacity-90 text-white px-8 py-3 rounded-lg font-bold transition duration-300">
                        إضافة العقار
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // دالة لإظهار نافذة تسجيل الدخول الرئيسية
        function showLoginModal() {
            document.getElementById('mainLoginModal').classList.remove('hidden');
        }
        
        // دالة لإظهار تنبيه (toast)
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded-lg text-white z-50 transition-opacity duration-300 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                'bg-blue-500'
            }`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('opacity-0');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }
        
        // إضافة مستمع لزر تسجيل الوسيط
        document.addEventListener('DOMContentLoaded', function() {
            // تفعيل زر إضافة عقار
            const addPropertyBtn = document.getElementById('addPropertyBtn');
            if (addPropertyBtn) {
                addPropertyBtn.addEventListener('click', function() {
                    document.getElementById('addPropertyModal').classList.remove('hidden');
                });
            }
            
            // تفعيل خاصية اختيار المنطقة أو كتابتها يدويًا في كل النماذج
            const regionSelects = [
                document.getElementById('regionSelect'),
                document.getElementById('propertyRegion')
            ];
            const customRegionContainers = [
                document.getElementById('customRegionContainer'),
                document.getElementById('customPropertyRegionContainer')
            ];
            
            regionSelects.forEach((select, index) => {
                if (select && customRegionContainers[index]) {
                    select.addEventListener('change', function() {
                        if (this.value === 'custom') {
                            customRegionContainers[index].style.display = 'block';
                        } else {
                            customRegionContainers[index].style.display = 'none';
                        }
                    });
                }
            });
            
            // تفعيل نموذج إضافة عقار
            const addPropertyForm = document.getElementById('addPropertyForm');
            if (addPropertyForm) {
                // معاينة الصور
                const propertyImagesInput = document.getElementById('propertyImages');
                const imagesPreviewContainer = document.getElementById('imagesPreviewContainer');
                
                if (propertyImagesInput && imagesPreviewContainer) {
                    propertyImagesInput.addEventListener('change', function(e) {
                        imagesPreviewContainer.innerHTML = '';
                        const files = e.target.files;
                        if (files) {
                            for (let i = 0; i < Math.min(files.length, 5); i++) {
                                const reader = new FileReader();
                                reader.onload = function(e) {
                                    const preview = document.createElement('div');
                                    preview.className = 'relative';
                                    preview.innerHTML = `
                                        <img src="${e.target.result}" class="w-24 h-24 object-cover rounded-lg" />
                                        <button type="button" class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center" data-index="${i}">
                                            <i class="fas fa-times text-xs"></i>
                                        </button>
                                    `;
                                    imagesPreviewContainer.appendChild(preview);
                                    
                                    // إضافة مستمع لزر حذف الصورة
                                    const deleteBtn = preview.querySelector('button');
                                    if (deleteBtn) {
                                        deleteBtn.addEventListener('click', function() {
                                            preview.remove();
                                        });
                                    }
                                };
                                reader.readAsDataURL(files[i]);
                            }
                        }
                    });
                }
                
                // تقديم النموذج
                addPropertyForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const title = document.getElementById('propertyTitle').value;
                    const price = document.getElementById('propertyPrice').value;
                    const type = document.getElementById('propertyTypeSelect').value;
                    const operation = document.getElementById('propertyOperation').value;
                    let region = document.getElementById('propertyRegion').value;
                    
                    // التحقق من المنطقة المخصصة
                    if (region === 'custom') {
                        region = document.getElementById('customPropertyRegion').value;
                    }
                    
                    const district = document.getElementById('propertyDistrict').value;
                    const area = document.getElementById('propertyArea').value;
                    const bedrooms = document.getElementById('propertyRooms').value;
                    const bathrooms = document.getElementById('propertyBathrooms').value;
                    const age = document.getElementById('propertyAge').value;
                    const description = document.getElementById('propertyDescription').value;
                    
                    // جمع المزايا
                    const amenities = {
                        centralAC: document.getElementById('amenityCentralAC').checked,
                        pool: document.getElementById('amenityPool').checked,
                        garden: document.getElementById('amenityGarden').checked,
                        kitchen: document.getElementById('amenityKitchen').checked,
                        security: document.getElementById('amenitySecurity').checked,
                        nearServices: document.getElementById('amenityNearServices').checked
                    };
                    
                    // إضافة العقار الجديد إلى localStorage
                    addNewProperty({
                        id: Date.now(),
                        title,
                        price: parseFloat(price),
                        type,
                        operation,
                        location: region && district ? `${region}، ${district}` : region || district,
                        customRegion: region === 'custom',
                        area: parseFloat(area),
                        bedrooms: parseInt(bedrooms) || 0,
                        bathrooms: parseInt(bathrooms) || 0,
                        yearBuilt: new Date().getFullYear() - (parseInt(age) || 0),
                        description,
                        amenities,
                        images: [], // سيتم معالجة الصور في الخطوة القادمة
                        views: 0,
                        createdAt: new Date().toISOString(),
                        agentId: getCurrentUser()?.id || null
                    });
                    
                    // إغلاق النموذج
                    document.getElementById('addPropertyModal').classList.add('hidden');
                    
                    // عرض رسالة نجاح
                    showToast('تم إضافة العقار بنجاح', 'success');
                });
            }
            
            // تفعيل روابط تسجيل الوسيط
            const registerBrokerLinks = [
                document.getElementById('registerBrokerLink'),
                document.getElementById('registerBrokerLink2')
            ];
            
            registerBrokerLinks.forEach(link => {
                if (link) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        // إخفاء نوافذ تسجيل الدخول
                        document.querySelectorAll('.modal').forEach(modal => {
                            modal.classList.add('hidden');
                        });
                        // إظهار نموذج تسجيل الوسيط
                        document.getElementById('brokerRegisterModal').classList.remove('hidden');
                    });
                }
            });
            
            // تفعيل زر إضافة محامي
            const addLawyerBtn = document.getElementById('addLawyerBtn');
            if (addLawyerBtn) {
                addLawyerBtn.addEventListener('click', function() {
                    document.getElementById('addLawyerModal').classList.remove('hidden');
                });
            }
            
            // تفعيل زر إضافة جهة تمويل
            const addFinanceBtn = document.getElementById('addFinanceBtn');
            if (addFinanceBtn) {
                addFinanceBtn.addEventListener('click', function() {
                    document.getElementById('addFinanceModal').classList.remove('hidden');
                });
            }
            
            // تفعيل علامات تبويب إدارة الحسابات
            const userTabButtons = [
                document.getElementById('tabBrokers'),
                document.getElementById('tabLawyers'),
                document.getElementById('tabFinance')
            ];
            
            const userTabContents = [
                document.getElementById('contentBrokers'),
                document.getElementById('contentLawyers'),
                document.getElementById('contentFinance')
            ];
            
            userTabButtons.forEach((btn, index) => {
                if (btn) {
                    btn.addEventListener('click', function() {
                        // إزالة الحالة النشطة من جميع الأزرار
                        userTabButtons.forEach(b => {
                            if (b) {
                                b.classList.remove('border-b-2', 'border-primary', 'text-primary');
                                b.classList.add('text-gray-500');
                            }
                        });
                        
                        // إضافة الحالة النشطة للزر المحدد
                        btn.classList.add('border-b-2', 'border-primary', 'text-primary');
                        btn.classList.remove('text-gray-500');
                        
                        // إخفاء جميع المحتويات
                        userTabContents.forEach(content => {
                            if (content) {
                                content.classList.add('hidden');
                            }
                        });
                        
                        // إظهار المحتوى المناسب
                        if (userTabContents[index]) {
                            userTabContents[index].classList.remove('hidden');
                        }
                    });
                }
            });
            
            // تفعيل تغيير اسم الموقع
            const saveSiteNameBtn = document.getElementById('saveSiteNameBtn');
            const siteNameInput = document.getElementById('siteName');
            
            if (saveSiteNameBtn && siteNameInput) {
                saveSiteNameBtn.addEventListener('click', function() {
                    const newSiteName = siteNameInput.value.trim();
                    if (newSiteName) {
                        // تحديث اسم الموقع في localStorage
                        const currentTheme = JSON.parse(localStorage.getItem('aqarak_theme') || '{}');
                        currentTheme.siteName = newSiteName;
                        localStorage.setItem('aqarak_theme', JSON.stringify(currentTheme));
                        
                        // تحديث العنوان المعروض مباشرة
                        const allSiteNameElements = document.querySelectorAll('.text-2xl.font-bold');
                        allSiteNameElements.forEach(el => {
                            if (el.textContent === 'النخبة العقارية') {
                                el.textContent = newSiteName;
                            }
                        });
                        
                        // عرض رسالة نجاح
                        showToast('تم تغيير اسم الموقع بنجاح', 'success');
                    } else {
                        // رسالة خطأ
                        showToast('الرجاء إدخال اسم للموقع', 'error');
                    }
                });
            }
            
            // تفعيل تحميل شعار الموقع
            const logoUpload = document.getElementById('logoUpload');
            const logoPreview = document.getElementById('logoPreview');
            
            if (logoUpload && logoPreview) {
                logoUpload.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.type.startsWith('image/')) {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                // تحديث الصورة المعروضة
                                logoPreview.innerHTML = '';
                                const img = document.createElement('img');
                                img.src = e.target.result;
                                img.classList.add('w-full', 'h-full', 'object-cover', 'rounded-full');
                                logoPreview.appendChild(img);
                                
                                // تخزين الشعار في localStorage
                                localStorage.setItem('aqarak_logo', e.target.result);
                                
                                // عرض رسالة نجاح
                                showToast('تم تحميل الشعار بنجاح', 'success');
                            };
                            reader.readAsDataURL(file);
                        } else {
                            showToast('الرجاء اختيار صورة فقط', 'error');
                        }
                    }
                });
            }
            
            // تفعيل إضافة شريك نجاح
            const addPartnerBtn = document.getElementById('addPartnerBtn');
            const partnerNameInput = document.getElementById('partnerName');
            const partnerLogoInput = document.getElementById('partnerLogo');
            const partnersContainer = document.getElementById('partnersContainer');
            
            if (addPartnerBtn && partnerNameInput && partnerLogoInput && partnersContainer) {
                // تحميل الشركاء السابقين
                loadPartners();
                
                addPartnerBtn.addEventListener('click', function() {
                    const name = partnerNameInput.value.trim();
                    const logoFile = partnerLogoInput.files && partnerLogoInput.files[0];
                    
                    if (name && logoFile) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // إضافة الشريك
                            addPartner(name, e.target.result);
                            
                            // إفراغ الحقول
                            partnerNameInput.value = '';
                            partnerLogoInput.value = '';
                            
                            // عرض رسالة نجاح
                            showToast('تم إضافة الشريك بنجاح', 'success');
                        };
                        reader.readAsDataURL(logoFile);
                    } else {
                        showToast('الرجاء إدخال اسم الشريك واختيار شعار', 'error');
                    }
                });
            }
            
            // تحميل اللوقو عند بدء التشغيل
            loadLogo();
            
            // تفعيل معالجة نماذج التسجيل
            const brokerRegisterForm = document.getElementById('brokerRegisterForm');
            if (brokerRegisterForm) {
                brokerRegisterForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('brokerName').value;
                    const whatsapp = document.getElementById('brokerWhatsapp').value;
                    const license = document.getElementById('brokerLicense').value;
                    const email = document.getElementById('brokerEmail').value;
                    
                    // إضافة طلب الوسيط الجديد
                    addPendingAgent({
                        id: Date.now(), // استخدام الوقت كمعرف مؤقت
                        name,
                        whatsapp,
                        licenseNumber: license,
                        status: 'pending'
                    });
                    
                    // إغلاق النموذج
                    document.getElementById('brokerRegisterModal').classList.add('hidden');
                    
                    // عرض تأكيد
                    document.getElementById('registrationSuccess').classList.remove('hidden');
                });
            }
            
            // تفعيل إضافة المحامي
            const addLawyerForm = document.getElementById('addLawyerForm');
            if (addLawyerForm) {
                addLawyerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('lawyerName').value;
                    const email = document.getElementById('lawyerEmail').value;
                    const phone = document.getElementById('lawyerPhone').value;
                    const password = document.getElementById('lawyerPassword').value;
                    
                    // إضافة المحامي الجديد
                    addLawyer({
                        id: Date.now(),
                        name,
                        email,
                        phone,
                        password,
                        createdAt: new Date().toISOString(),
                        status: 'active'
                    });
                    
                    // إغلاق النموذج
                    document.getElementById('addLawyerModal').classList.add('hidden');
                    
                    // تحديث عرض المحامين
                    updateLawyersDisplay();
                    
                    // عرض رسالة نجاح
                    showToast('تم إضافة المحامي بنجاح', 'success');
                });
            }
            
            // تفعيل إضافة جهة تمويل
            const addFinanceForm = document.getElementById('addFinanceForm');
            if (addFinanceForm) {
                addFinanceForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('financeName').value;
                    const email = document.getElementById('financeEmail').value;
                    const phone = document.getElementById('financePhone').value;
                    const password = document.getElementById('financePassword').value;
                    
                    // إضافة جهة التمويل الجديدة
                    addFinanceEntity({
                        id: Date.now(),
                        name,
                        email,
                        phone,
                        password,
                        createdAt: new Date().toISOString(),
                        status: 'active'
                    });
                    
                    // إغلاق النموذج
                    document.getElementById('addFinanceModal').classList.add('hidden');
                    
                    // تحديث عرض جهات التمويل
                    updateFinanceEntitiesDisplay();
                    
                    // عرض رسالة نجاح
                    showToast('تم إضافة جهة التمويل بنجاح', 'success');
                });
            }
        });
        
        // دالة لتحميل اللوقو
        function loadLogo() {
            const logoPreview = document.getElementById('logoPreview');
            if (!logoPreview) return;
            
            const savedLogo = localStorage.getItem('aqarak_logo');
            if (savedLogo) {
                logoPreview.innerHTML = '';
                const img = document.createElement('img');
                img.src = savedLogo;
                img.classList.add('w-full', 'h-full', 'object-cover', 'rounded-full');
                logoPreview.appendChild(img);
            }
        }
        
        // دالة لتحميل الشركاء
        function loadPartners() {
            const partnersContainer = document.getElementById('partnersContainer');
            if (!partnersContainer) return;
            
            const partners = JSON.parse(localStorage.getItem('aqarak_partners') || '[]');
            
            if (partners.length > 0) {
                partnersContainer.innerHTML = '';
                partners.forEach(partner => {
                    const partnerDiv = createPartnerElement(partner.name, partner.logo);
                    partnersContainer.appendChild(partnerDiv);
                });
            } else {
                partnersContainer.innerHTML = '<div class="text-center text-gray-500">لا يوجد شركاء حالياً</div>';
            }
        }
        
        // دالة لإضافة شريك
        function addPartner(name, logo) {
            const partners = JSON.parse(localStorage.getItem('aqarak_partners') || '[]');
            partners.push({ name, logo });
            localStorage.setItem('aqarak_partners', JSON.stringify(partners));
            
            // تحديث العرض
            loadPartners();
        }
        
        // دالة لإنشاء عنصر شريك
        function createPartnerElement(name, logo) {
            const partnerDiv = document.createElement('div');
            partnerDiv.className = 'flex flex-col items-center p-2 border rounded-lg w-24';
            
            const logoImg = document.createElement('img');
            logoImg.src = logo;
            logoImg.className = 'w-16 h-16 object-contain mb-2';
            
            const partnerName = document.createElement('p');
            partnerName.className = 'text-xs text-center font-medium';
            partnerName.textContent = name;
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'text-red-500 text-xs mt-1';
            removeBtn.innerHTML = '<i class="fas fa-trash"></i> حذف';
            removeBtn.onclick = function() {
                removePartner(name);
            };
            
            partnerDiv.appendChild(logoImg);
            partnerDiv.appendChild(partnerName);
            partnerDiv.appendChild(removeBtn);
            
            return partnerDiv;
        }
        
        // دالة لحذف شريك
        function removePartner(name) {
            const partners = JSON.parse(localStorage.getItem('aqarak_partners') || '[]');
            const updatedPartners = partners.filter(partner => partner.name !== name);
            localStorage.setItem('aqarak_partners', JSON.stringify(updatedPartners));
            
            // تحديث العرض
            loadPartners();
            
            // عرض رسالة نجاح
            showToast('تم حذف الشريك بنجاح', 'success');
        }
        
        // إضافة طلب وسيط جديد
        function addPendingAgent(agent) {
            const pendingAgents = JSON.parse(localStorage.getItem('aqarak_pending_agents') || '[]');
            pendingAgents.push(agent);
            localStorage.setItem('aqarak_pending_agents', JSON.stringify(pendingAgents));
        }
        
        // إضافة محامي جديد
        function addLawyer(lawyer) {
            const lawyers = JSON.parse(localStorage.getItem('aqarak_lawyers') || '[]');
            lawyers.push(lawyer);
            localStorage.setItem('aqarak_lawyers', JSON.stringify(lawyers));
            
            // تحديث الإحصائية
            updateLawyersCount();
        }
        
        // تحديث عدد المحامين في اللوحة
        function updateLawyersCount() {
            const totalLawyersElement = document.getElementById('totalLawyers');
            if (totalLawyersElement) {
                const lawyers = JSON.parse(localStorage.getItem('aqarak_lawyers') || '[]');
                totalLawyersElement.textContent = lawyers.length;
            }
        }
        
        // تحديث عرض المحامين
        function updateLawyersDisplay() {
            const lawyersTable = document.getElementById('lawyersTable');
            if (!lawyersTable) return;
            
            const lawyers = JSON.parse(localStorage.getItem('aqarak_lawyers') || '[]');
            
            if (lawyers.length > 0) {
                lawyersTable.innerHTML = '';
                lawyers.forEach(lawyer => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${lawyer.name}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${lawyer.email}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${lawyer.phone}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${new Date(lawyer.createdAt).toLocaleDateString('ar-SA')}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                نشط
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button class="text-red-600 hover:text-red-900 ml-2" onclick="deleteLawyer(${lawyer.id})">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                            <button class="text-yellow-600 hover:text-yellow-900" onclick="toggleLawyerStatus(${lawyer.id})">
                                <i class="fas fa-ban"></i> إيقاف
                            </button>
                        </td>
                    `;
                    
                    lawyersTable.appendChild(row);
                });
            } else {
                lawyersTable.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">لا يوجد محامين حالياً</td></tr>';
            }
        }
        
        // حذف محامي
        function deleteLawyer(id) {
            const lawyers = JSON.parse(localStorage.getItem('aqarak_lawyers') || '[]');
            const updatedLawyers = lawyers.filter(lawyer => lawyer.id !== id);
            localStorage.setItem('aqarak_lawyers', JSON.stringify(updatedLawyers));
            
            // تحديث العرض
            updateLawyersDisplay();
            updateLawyersCount();
            
            // عرض رسالة نجاح
            showToast('تم حذف المحامي بنجاح', 'success');
        }
        
        // تغيير حالة المحامي
        function toggleLawyerStatus(id) {
            const lawyers = JSON.parse(localStorage.getItem('aqarak_lawyers') || '[]');
            const updatedLawyers = lawyers.map(lawyer => {
                if (lawyer.id === id) {
                    return {
                        ...lawyer,
                        status: lawyer.status === 'active' ? 'inactive' : 'active'
                    };
                }
                return lawyer;
            });
            
            localStorage.setItem('aqarak_lawyers', JSON.stringify(updatedLawyers));
            
            // تحديث العرض
            updateLawyersDisplay();
            
            // عرض رسالة نجاح
            showToast('تم تغيير حالة المحامي بنجاح', 'success');
        }
        
        // إضافة جهة تمويل جديدة
        function addFinanceEntity(entity) {
            const entities = JSON.parse(localStorage.getItem('aqarak_finance_entities') || '[]');
            entities.push(entity);
            localStorage.setItem('aqarak_finance_entities', JSON.stringify(entities));
            
            // تحديث عرض جهات التمويل
            updateFinanceEntitiesDisplay();
        }
        
        // تحديث عرض جهات التمويل
        function updateFinanceEntitiesDisplay() {
            const financeTable = document.getElementById('financeTable');
            if (!financeTable) return;
            
            const entities = JSON.parse(localStorage.getItem('aqarak_finance_entities') || '[]');
            
            if (entities.length > 0) {
                financeTable.innerHTML = '';
                entities.forEach(entity => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${entity.name}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${entity.email}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${entity.phone}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-500">${new Date(entity.createdAt).toLocaleDateString('ar-SA')}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                نشط
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button class="text-red-600 hover:text-red-900 ml-2" onclick="deleteFinanceEntity(${entity.id})">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                            <button class="text-yellow-600 hover:text-yellow-900" onclick="toggleFinanceEntityStatus(${entity.id})">
                                <i class="fas fa-ban"></i> إيقاف
                            </button>
                        </td>
                    `;
                    
                    financeTable.appendChild(row);
                });
            } else {
                financeTable.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">لا توجد جهات تمويل حالياً</td></tr>';
            }
        }
        
        // حذف جهة تمويل
        function deleteFinanceEntity(id) {
            const entities = JSON.parse(localStorage.getItem('aqarak_finance_entities') || '[]');
            const updatedEntities = entities.filter(entity => entity.id !== id);
            localStorage.setItem('aqarak_finance_entities', JSON.stringify(updatedEntities));
            
            // تحديث العرض
            updateFinanceEntitiesDisplay();
            
            // عرض رسالة نجاح
            showToast('تم حذف جهة التمويل بنجاح', 'success');
        }
        
        // تغيير حالة جهة التمويل
        function toggleFinanceEntityStatus(id) {
            const entities = JSON.parse(localStorage.getItem('aqarak_finance_entities') || '[]');
            const updatedEntities = entities.map(entity => {
                if (entity.id === id) {
                    return {
                        ...entity,
                        status: entity.status === 'active' ? 'inactive' : 'active'
                    };
                }
                return entity;
            });
            
            localStorage.setItem('aqarak_finance_entities', JSON.stringify(updatedEntities));
            
            // تحديث العرض
            updateFinanceEntitiesDisplay();
            
            // عرض رسالة نجاح
            showToast('تم تغيير حالة جهة التمويل بنجاح', 'success');
        }
    </script>
</body>
</html>
